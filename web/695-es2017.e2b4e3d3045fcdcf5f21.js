"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[695],{5695:function(t,e,i){i.r(e),i.d(e,{StoreModule:function(){return wt}});var n=i(8583),o=i(665),r=i(8288),a=i(2561),l=i(4466),s=i(6516),c=i(5121),u=i(7872),d=i(7965),p=i(8598),Z=i(7564),g=i(6949),m=i(1526),h=i(4207),q=i(103),A=i(4748),f=i(8220),v=i(3928),T=i(7716),_=i(2777);const b=function(){return["is-active"]};function y(t,e){1&t&&(T.TgZ(0,"li",4),T.TgZ(1,"a",5),T._uU(2,"Stock"),T.qZA(),T.qZA()),2&t&&(T.xp6(1),T.Q6J("routerLinkActive",T.DdM(1,b)))}function x(t,e){1&t&&(T.TgZ(0,"li",4),T.TgZ(1,"a",6),T._uU(2,"Stock 2"),T.qZA(),T.qZA()),2&t&&(T.xp6(1),T.Q6J("routerLinkActive",T.DdM(1,b)))}function U(t,e){1&t&&(T.TgZ(0,"li",4),T.TgZ(1,"a",7),T._uU(2,"Cash"),T.qZA(),T.qZA()),2&t&&(T.xp6(1),T.Q6J("routerLinkActive",T.DdM(1,b)))}function k(t,e){1&t&&(T.TgZ(0,"li",4),T.TgZ(1,"a",8),T._uU(2,"Credit"),T.qZA(),T.qZA()),2&t&&(T.xp6(1),T.Q6J("routerLinkActive",T.DdM(1,b)))}let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:10,vars:0,consts:[[1,"pagetitle"],[1,"page-menu","navbar","navbar-light","bg-light","justify-content-between","non-print","m-0","p-0"],[1,"nav"],["class","nav-item",4,"isNavAuth"],[1,"nav-item"],["routerLink","stock",1,"nav-link",3,"routerLinkActive"],["routerLink","inventory",1,"nav-link",3,"routerLinkActive"],["routerLink","cash",1,"nav-link",3,"routerLinkActive"],["routerLink","credit",1,"nav-link",3,"routerLinkActive"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"h1"),T._uU(2,"Store"),T.qZA(),T.qZA(),T.TgZ(3,"nav",1),T.TgZ(4,"ul",2),T.YNc(5,y,3,2,"li",3),T.YNc(6,x,3,2,"li",3),T.YNc(7,U,3,2,"li",3),T.YNc(8,k,3,2,"li",3),T.qZA(),T.qZA(),T._UZ(9,"router-outlet"))},directives:[_.x,r.lC,r.yS,r.Od],encapsulation:2}),t})(),C=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&T._uU(0," Cash Component\n")},encapsulation:2}),t})();const O=function(){return["is-active"]};let M=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:15,vars:8,consts:[[1,"navbar","navbar-light","bg-light","justify-content-between","m-0","p-0"],[1,"nav"],[1,"nav-item"],["routerLink","list",1,"nav-link",3,"routerLinkActive"],["routerLink","audit",1,"nav-link",3,"routerLinkActive"],["routerLink","adjust",1,"nav-link",3,"routerLinkActive"],["routerLink","demand",1,"nav-link",3,"routerLinkActive"]],template:function(t,e){1&t&&(T.TgZ(0,"nav",0),T.TgZ(1,"ul",1),T.TgZ(2,"li",2),T.TgZ(3,"a",3),T._uU(4,"Inventory"),T.qZA(),T.qZA(),T.TgZ(5,"li",2),T.TgZ(6,"a",4),T._uU(7,"Audit"),T.qZA(),T.qZA(),T.TgZ(8,"li",2),T.TgZ(9,"a",5),T._uU(10,"Adjustments"),T.qZA(),T.qZA(),T.TgZ(11,"li",2),T.TgZ(12,"a",6),T._uU(13,"Demand"),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T._UZ(14,"router-outlet")),2&t&&(T.xp6(3),T.Q6J("routerLinkActive",T.DdM(4,O)),T.xp6(3),T.Q6J("routerLinkActive",T.DdM(5,O)),T.xp6(3),T.Q6J("routerLinkActive",T.DdM(6,O)),T.xp6(3),T.Q6J("routerLinkActive",T.DdM(7,O)))},directives:[r.yS,r.Od,r.lC],encapsulation:2}),t})();var j=i(2912),S=i(5414),I=i(139),J=i(6391),Q=i(3013);function N(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr"),T.TgZ(1,"th"),T.TgZ(2,"input",13),T.NdJ("change",function(e){return T.CHM(t),T.oxw().selectAllItem(e)}),T.qZA(),T.qZA(),T.TgZ(3,"th",14),T._uU(4,"Invoice No "),T._UZ(5,"p-columnFilter",15),T._UZ(6,"p-sortIcon",16),T.qZA(),T.TgZ(7,"th",17),T._uU(8,"Product "),T._UZ(9,"p-columnFilter",18),T._UZ(10,"p-sortIcon",19),T.qZA(),T.TgZ(11,"th",20),T._uU(12,"Expiry "),T._UZ(13,"p-sortIcon",21),T.qZA(),T.TgZ(14,"th"),T._uU(15,"Purchased"),T.qZA(),T.TgZ(16,"th",22),T._uU(17,"Sold "),T._UZ(18,"p-columnFilter",23),T._UZ(19,"p-sortIcon",24),T.qZA(),T.TgZ(20,"th"),T._uU(21,"Adjusted"),T.qZA(),T.TgZ(22,"th",25),T._uU(23,"Available "),T._UZ(24,"p-columnFilter",26),T._UZ(25,"p-sortIcon",27),T.qZA(),T.TgZ(26,"th"),T._uU(27,"Actions"),T.qZA(),T.qZA()}}const F=function(t){return["/secure/purchases/items",t]};function P(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr"),T.TgZ(1,"td"),T.TgZ(2,"input",28),T.NdJ("change",function(e){const i=T.CHM(t).$implicit;return T.oxw().selectItem(e,i.id)}),T.qZA(),T.qZA(),T.TgZ(3,"td"),T.TgZ(4,"a",29),T._uU(5),T.qZA(),T.qZA(),T.TgZ(6,"td"),T.TgZ(7,"p",30),T._uU(8),T.qZA(),T.TgZ(9,"span",31),T._uU(10),T.qZA(),T.qZA(),T.TgZ(11,"td"),T._uU(12),T.ALo(13,"date"),T.qZA(),T.TgZ(14,"td",32),T._uU(15),T.qZA(),T.TgZ(16,"td",32),T._uU(17),T.qZA(),T.TgZ(18,"td",32),T._uU(19),T.qZA(),T.TgZ(20,"td",32),T._uU(21),T.qZA(),T._UZ(22,"td",33),T.qZA()}if(2&t){const t=e.$implicit;T.xp6(2),T.Q6J("checked",t.selected),T.xp6(2),T.Q6J("routerLink",T.VKq(13,F,t.purchase_invoiceid)),T.xp6(1),T.Oqu(t.invoice_no),T.xp6(3),T.Oqu(t.product_title),T.xp6(2),T.Oqu(t.product_batch),T.xp6(2),T.Oqu(T.xi3(13,10,t.product_expdate,"MMM-yy")),T.xp6(3),T.Oqu(t.purchased),T.xp6(2),T.Oqu(t.sold),T.xp6(2),T.Oqu(t.adjusted),T.xp6(2),T.Oqu(t.available)}}const D=function(){return[25,50,100]};let L=(()=>{class t{constructor(t,e,i){this.service=t,this.invoiceService=e,this.dateService=i,this.items=[],this.displayQtyAdjForm=!1,this.selectedItem={},this.finalqty=0,this.maxAllowed=0,this.minAllowed=0,this.available=!0,this.expired=!1,this.inactive=!1,this.qtyAdjustForm=new o.cw({itemid:new o.NI("",o.kI.required),reason:new o.NI("Other",o.kI.required),qty:new o.NI(0,o.kI.required),comments:new o.NI("")}),this.qtyChangeReasons=[{value:"Damaged",label:"Damaged"},{value:"Missing",label:"Missing"},{value:"Expired",label:"Expired"},{value:"Other",label:"Other"}]}ngOnInit(){this.fetchStock()}fetchStock(){this.service.filterByCriteria({status:"VERIFIED",id:this.selectedItem.id,title:this.selectedItem.title,available:this.available,expired:this.expired,starts:!0}).subscribe(t=>{this.items=t.map(t=>Object.assign(Object.assign({},t),{available:+t.available}))})}selectItem(t,e){this.items.forEach(t=>{t.id==e&&(t.selected=!0)})}selectAllItem(t){this.items.forEach(e=>{e.selected=t.target.checked})}isItemsSelected(){return this.items.filter(t=>t.selected).length>0}onProductSelect(t){this.selectedItem=t,this.fetchStock()}audit(){const t=[];this.items.forEach(e=>{e.selected&&t.push(e.id)}),this.invoiceService.updateItems(t,{status:"AUDIT",verifystartdate:this.dateService.getFormatDate(new Date)}).subscribe(t=>this.fetchStock())}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(j.q),T.Y36(S.q),T.Y36(I.m))},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:18,vars:10,consts:[[1,"row","mt-2"],[1,"col-12"],[1,"d-flex"],["type","checkbox","name","available","id","available",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","available",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],["type","checkbox","name","expired","id","expired",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","expired",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],[3,"selected"],[1,"btn","btn-outline-info",3,"disabled","click"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["type","checkbox",1,"form-conrol-input","checkmark",3,"change"],["pSortableColumn","invoice_no"],["type","text","field","invoice_no","display","menu"],["field","invoice_no"],["pSortableColumn","product_title"],["type","text","field","product_title","display","menu"],["field","product_title"],["pSortableColumn","product_expdate"],["field","product_expdate"],["pSortableColumn","sold"],["type","numeric","field","sold","display","menu"],["field","sold"],["pSortableColumn","available"],["type","numeric","field","available","display","menu"],["field","available"],["type","checkbox",1,"form-conrol-input","checkmark",3,"checked","change"],[3,"routerLink"],[1,"m-0"],[1,"batch"],[1,"text-end"],[1,"text-center"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T.TgZ(2,"div",2),T.TgZ(3,"input",3),T.NdJ("ngModelChange",function(t){return e.available=t})("change",function(){return e.fetchStock()}),T.qZA(),T.TgZ(4,"label",4),T._uU(5,"Available"),T.qZA(),T.TgZ(6,"input",5),T.NdJ("ngModelChange",function(t){return e.expired=t})("change",function(){return e.fetchStock()}),T.qZA(),T.TgZ(7,"label",6),T._uU(8,"Expired"),T.qZA(),T.TgZ(9,"app-product-select",7),T.NdJ("selected",function(t){return e.onProductSelect(t)}),T.qZA(),T.qZA(),T.qZA(),T.TgZ(10,"div",1),T.TgZ(11,"button",8),T.NdJ("click",function(){return e.audit()}),T._uU(12,"Audit"),T.qZA(),T.qZA(),T.TgZ(13,"div",1),T.TgZ(14,"p-table",9,10),T.YNc(16,N,28,0,"ng-template",11),T.YNc(17,P,23,15,"ng-template",12),T.qZA(),T.qZA(),T.qZA()),2&t&&(T.xp6(3),T.Q6J("ngModel",e.available),T.xp6(3),T.Q6J("ngModel",e.expired),T.xp6(5),T.Q6J("disabled",!e.isItemsSelected()),T.xp6(3),T.Q6J("value",e.items)("resizableColumns",!0)("paginator",!0)("rows",25)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(9,D)))},directives:[o.Wl,o.JJ,o.On,J.q,u.iA,Q.jx,u.lQ,u.xl,u.fz,r.yS],pipes:[n.uU],styles:[".adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t})();function Y(t,e){1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"th",6),T._uU(2,"Product "),T._UZ(3,"p-columnFilter",7),T._UZ(4,"p-sortIcon",8),T.qZA(),T.TgZ(5,"th",9),T._uU(6,"Qty "),T._UZ(7,"p-sortIcon",10),T.qZA(),T.TgZ(8,"th",11),T._uU(9,"Date "),T._UZ(10,"p-columnFilter",12),T._UZ(11,"p-sortIcon",13),T.qZA(),T.TgZ(12,"th",14),T._uU(13,"Reason "),T._UZ(14,"p-sortIcon",15),T.qZA(),T.TgZ(15,"th"),T._uU(16,"Actions"),T.qZA(),T.qZA())}function R(t,e){1&t&&(T.TgZ(0,"h5",19),T._UZ(1,"i",22),T.qZA())}function E(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr"),T.TgZ(1,"td"),T.TgZ(2,"p",16),T._uU(3),T.qZA(),T.TgZ(4,"span",17),T._uU(5),T.ALo(6,"date"),T.qZA(),T.qZA(),T.TgZ(7,"td"),T._uU(8),T.qZA(),T.TgZ(9,"td"),T._uU(10),T.ALo(11,"date"),T.qZA(),T.TgZ(12,"td"),T._uU(13),T.YNc(14,R,2,0,"h5",18),T.qZA(),T.TgZ(15,"td"),T.TgZ(16,"h5",19),T.TgZ(17,"a",20),T.NdJ("click",function(){const e=T.CHM(t).$implicit;return T.oxw().delete(e.id)}),T._UZ(18,"i",21),T.qZA(),T.qZA(),T.qZA(),T.qZA()}if(2&t){const t=e.$implicit;T.xp6(3),T.Oqu(t.title),T.xp6(2),T.AsE("",t.batch,"/",T.xi3(6,7,t.expdate,"MMM-yy"),""),T.xp6(3),T.Oqu(t.qty),T.xp6(2),T.Oqu(T.xi3(11,10,t.date,"dd/MM/yyyy")),T.xp6(3),T.hij("",t.reason," "),T.xp6(1),T.Q6J("ngIf",t.comments)}}const z=function(){return[10,25,50]};let B=(()=>{class t{constructor(t){this.stockService=t,this.quantities=[]}ngOnInit(){this.fetchAdjustments()}fetchAdjustments(){this.stockService.findAllQtyAdjustments().subscribe(t=>{this.quantities=t})}edit(t){}delete(t){this.stockService.deleteQtyAdjustment(t).subscribe(t=>{this.fetchAdjustments()})}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(j.q))},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:6,vars:7,consts:[[1,"row","mt-2"],[1,"col-12"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt2",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","title"],["type","text","field","title","display","menu"],["field","title"],["pSortableColumn","qty"],["field","qty"],["pSortableColumn","date"],["type","date","field","date","display","menu"],["field","date"],["pSortableColumn","reason"],["field","reason"],[1,"m-0"],[1,"batch"],["style","float:left; margin-right: 0.3em;",4,"ngIf"],[2,"float","left","margin-right","0.3em"],[3,"click"],[1,"bi","bi-trash","text-danger"],[1,"bi","bi-chat","text-danger"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T.TgZ(2,"p-table",2,3),T.YNc(4,Y,17,0,"ng-template",4),T.YNc(5,E,19,13,"ng-template",5),T.qZA(),T.qZA(),T.qZA()),2&t&&(T.xp6(2),T.Q6J("value",e.quantities)("resizableColumns",!0)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(6,z)))},directives:[u.iA,Q.jx,u.lQ,u.xl,u.fz,n.O5],pipes:[n.uU],styles:[".adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t})();function $(t,e){1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"th",8),T._uU(2,"ID "),T._UZ(3,"p-columnFilter",9),T._UZ(4,"p-sortIcon",10),T.qZA(),T.TgZ(5,"th",11),T._uU(6,"Product "),T._UZ(7,"p-columnFilter",12),T._UZ(8,"p-sortIcon",13),T.qZA(),T.TgZ(9,"th",14),T._uU(10,"Order Since "),T._UZ(11,"p-columnFilter",15),T._UZ(12,"p-sortIcon",16),T.qZA(),T.TgZ(13,"th",17),T._uU(14,"Order Freq "),T._UZ(15,"p-columnFilter",18),T._UZ(16,"p-sortIcon",19),T.qZA(),T.TgZ(17,"th",20),T._uU(18,"Orders "),T._UZ(19,"p-sortIcon",21),T.qZA(),T.TgZ(20,"th",22),T._uU(21,"Sold Qty "),T._UZ(22,"p-sortIcon",23),T.qZA(),T.TgZ(23,"th",24),T._uU(24,"Avai Qty "),T._UZ(25,"p-sortIcon",25),T.qZA(),T.TgZ(26,"th",26),T._uU(27,"Start Date "),T._UZ(28,"p-columnFilter",27),T._UZ(29,"p-sortIcon",28),T.qZA(),T.TgZ(30,"th",29),T._uU(31,"Last Date "),T._UZ(32,"p-columnFilter",30),T._UZ(33,"p-sortIcon",31),T.qZA(),T.qZA())}function V(t,e){if(1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"td"),T._uU(2),T.qZA(),T.TgZ(3,"td"),T._uU(4),T.qZA(),T.TgZ(5,"td"),T._uU(6),T.qZA(),T.TgZ(7,"td"),T._uU(8),T.qZA(),T.TgZ(9,"td"),T._uU(10),T.qZA(),T.TgZ(11,"td"),T._uU(12),T.qZA(),T.TgZ(13,"td"),T._uU(14),T.qZA(),T.TgZ(15,"td"),T._uU(16),T.ALo(17,"date"),T.qZA(),T.TgZ(18,"td"),T._uU(19),T.ALo(20,"date"),T.qZA(),T.qZA()),2&t){const t=e.$implicit;T.xp6(2),T.Oqu(t.id),T.xp6(2),T.Oqu(t.title),T.xp6(2),T.Oqu(t.order_since),T.xp6(2),T.Oqu(t.orders_freq),T.xp6(2),T.Oqu(t.total_orders),T.xp6(2),T.Oqu(t.sold_qty),T.xp6(2),T.Oqu(t.avail_qty),T.xp6(2),T.Oqu(T.xi3(17,9,t.start_order_date,"dd/MM/yyyy")),T.xp6(3),T.Oqu(T.xi3(20,12,t.end_order_date,"dd/MM/yyyy"))}}const X=function(){return[10,25,50]};let H=(()=>{class t{constructor(t,e){this.stockService=t,this.dateUtilService=e,this.items=[],this.fromdate="",this.todate="",this.incother=!1}ngOnInit(){this.fromdate=this.dateUtilService.getOtherDate(new Date,-90),this.todate=this.dateUtilService.getFormatDate(new Date),this.incother=!1,this.filter()}filter(){console.log("incother: ",this.incother),this.stockService.findDemand(this.fromdate,this.todate,!this.incother).subscribe(t=>{this.items=t})}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(j.q),T.Y36(I.m))},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:13,vars:12,consts:[[1,"row"],[1,"col-12"],["type","date",3,"ngModel","max","ngModelChange","input"],["type","checkbox",3,"ngModel","ngModelChange","change"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","id"],["type","text","field","id","display","menu"],["field","id"],["pSortableColumn","title"],["type","text","field","title","display","menu"],["field","title"],["pSortableColumn","order_since"],["type","text","field","order_since","display","menu"],["field","order_since"],["pSortableColumn","orders_freq"],["type","text","field","orders_freq","display","menu"],["field","orders_freq"],["pSortableColumn","total_orders"],["field","total_orders"],["pSortableColumn","sold_qty"],["field","sold_qty"],["pSortableColumn","avail_qty"],["field","avail_qty"],["pSortableColumn","start_order_date"],["type","date","field","start_order_date","display","menu"],["field","start_order_date"],["pSortableColumn","end_order_date"],["type","date","field","end_order_date","display","menu"],["field","end_order_date"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T._uU(2," From: "),T.TgZ(3,"input",2),T.NdJ("ngModelChange",function(t){return e.fromdate=t})("input",function(){return e.filter()}),T.qZA(),T._uU(4," To: "),T.TgZ(5,"input",2),T.NdJ("ngModelChange",function(t){return e.todate=t})("input",function(){return e.filter()}),T.qZA(),T.TgZ(6,"input",3),T.NdJ("ngModelChange",function(t){return e.incother=t})("change",function(){return e.filter()}),T.qZA(),T._uU(7," Include Other "),T.qZA(),T.TgZ(8,"div",1),T.TgZ(9,"p-table",4,5),T.YNc(11,$,34,0,"ng-template",6),T.YNc(12,V,21,15,"ng-template",7),T.qZA(),T.qZA(),T.qZA()),2&t&&(T.xp6(3),T.Q6J("ngModel",e.fromdate)("max",e.todate),T.xp6(2),T.Q6J("ngModel",e.todate)("max",e.todate),T.xp6(1),T.Q6J("ngModel",e.incother),T.xp6(3),T.Q6J("value",e.items)("resizableColumns",!0)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(11,X)))},directives:[o.Fj,o.JJ,o.On,o.Wl,u.iA,Q.jx,u.lQ,u.xl,u.fz],pipes:[n.uU],styles:[".batch[_ngcontent-%COMP%]{color:#00f;font-style:italic;font-size:smaller}.adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t})(),K=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&T._uU(0," Credit Component\n")},encapsulation:2}),t})();function W(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr"),T.TgZ(1,"th"),T.TgZ(2,"input",34),T.NdJ("change",function(e){return T.CHM(t),T.oxw().selectAllItem(e)}),T.qZA(),T.qZA(),T.TgZ(3,"th",35),T._uU(4,"Invoice No "),T._UZ(5,"p-columnFilter",36),T._UZ(6,"p-sortIcon",37),T.qZA(),T.TgZ(7,"th",38),T._uU(8,"Product "),T._UZ(9,"p-columnFilter",39),T._UZ(10,"p-sortIcon",40),T.qZA(),T.TgZ(11,"th",41),T._uU(12,"Expiry "),T._UZ(13,"p-sortIcon",42),T.qZA(),T.TgZ(14,"th"),T._uU(15,"Purchased"),T.qZA(),T.TgZ(16,"th"),T._uU(17,"Sold"),T.qZA(),T.TgZ(18,"th"),T._uU(19,"Adjusted"),T.qZA(),T.TgZ(20,"th",43),T._uU(21,"Available "),T._UZ(22,"p-columnFilter",44),T._UZ(23,"p-sortIcon",45),T.qZA(),T.TgZ(24,"th"),T._uU(25,"Actions"),T.qZA(),T.qZA()}}const G=function(t){return["/secure/purchases/items",t]};function tt(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr"),T.TgZ(1,"td"),T.TgZ(2,"input",46),T.NdJ("change",function(e){const i=T.CHM(t).$implicit;return T.oxw().selectItem(e,i.id)}),T.qZA(),T.qZA(),T.TgZ(3,"td"),T.TgZ(4,"a",47),T._uU(5),T.qZA(),T.qZA(),T.TgZ(6,"td"),T.TgZ(7,"p"),T._uU(8),T.qZA(),T.TgZ(9,"span",16),T._uU(10),T.qZA(),T.qZA(),T.TgZ(11,"td"),T._uU(12),T.ALo(13,"date"),T.qZA(),T.TgZ(14,"td",48),T._uU(15),T.qZA(),T.TgZ(16,"td",48),T._uU(17),T.qZA(),T.TgZ(18,"td",48),T._uU(19),T.qZA(),T.TgZ(20,"td",48),T._uU(21),T.qZA(),T.TgZ(22,"td",49),T.TgZ(23,"span",50),T._uU(24," \xa0"),T.TgZ(25,"a",51),T.NdJ("click",function(){const e=T.CHM(t).$implicit;return T.oxw().showQtyDialog(e)}),T._UZ(26,"i",52),T.qZA(),T.qZA(),T.qZA(),T.qZA()}if(2&t){const t=e.$implicit;T.xp6(2),T.Q6J("checked",t.selected),T.xp6(2),T.Q6J("routerLink",T.VKq(13,G,t.purchase_invoiceid)),T.xp6(1),T.Oqu(t.invoice_no),T.xp6(3),T.Oqu(t.product_title),T.xp6(2),T.Oqu(t.product_batch),T.xp6(2),T.Oqu(T.xi3(13,10,t.product_expdate,"MMM-yy")),T.xp6(3),T.Oqu(t.purchased),T.xp6(2),T.Oqu(t.sold),T.xp6(2),T.Oqu(t.adjusted),T.xp6(2),T.Oqu(t.available)}}function et(t,e){if(1&t&&(T.TgZ(0,"option",53),T._uU(1),T.qZA()),2&t){const t=e.$implicit;T.Q6J("value",t.value),T.xp6(1),T.Oqu(t.label)}}function it(t,e){if(1&t&&(T.TgZ(0,"option",53),T._uU(1),T.qZA()),2&t){const t=e.$implicit;T.Q6J("value",t.value),T.xp6(1),T.Oqu(t.label)}}const nt=function(){return[25,50,100]};let ot=(()=>{class t{constructor(t,e,i){this.service=t,this.invoiceService=e,this.dateService=i,this.items=[],this.displayQtyAdjForm=!1,this.displayQtyBulkAdjForm=!1,this.finalqty=0,this.maxAllowed=0,this.minAllowed=0,this.available=!0,this.expired=!1,this.inactive=!1,this.qtyAdjustForm=new o.cw({itemid:new o.NI("",o.kI.required),reason:new o.NI("",o.kI.required),qty:new o.NI(0,o.kI.required),comments:new o.NI("")}),this.qtyBulkAdjustForm=new o.cw({reason:new o.NI("",o.kI.required),comments:new o.NI("")}),this.qtyChangeReasons=[{value:"Damaged",label:"Damaged"},{value:"Missing",label:"Missing"},{value:"Expired",label:"Expired"},{value:"Other",label:"Other"}]}ngOnInit(){this.fetchStock()}complete(){const t=[];this.items.forEach(e=>{e.selected&&t.push(e.id)}),this.invoiceService.updateItems(t,{status:"VERIFIED",verifyenddate:this.dateService.getFormatDate(new Date)}).subscribe(t=>this.fetchStock())}bulkadjust(){this.displayQtyBulkAdjForm=!0}fetchStock(){this.service.filterByCriteria({available:this.available,expired:this.expired,status:"AUDIT"}).subscribe(t=>{this.items=t.map(t=>Object.assign(Object.assign({},t),{available:+t.available}))})}selectItem(t,e){this.items.forEach(t=>{t.id==e&&(t.selected=!0)})}selectAllItem(t){this.items.forEach(e=>{e.selected=t.target.checked})}showQtyDialog(t){this.selectedItem=t,this.qtyAdjustForm.reset(),this.qtyAdjustForm.controls.itemid.setValue(t.purchase_itemid),this.displayQtyAdjForm=!0,this.finalqty=this.selectedItem.available,this.minAllowed=-1*+this.selectedItem.available}onQtyAdjSubmit(){this.service.updateQty(this.qtyAdjustForm.value).subscribe(t=>{this.fetchStock(),this.displayQtyAdjForm=!1})}isItemsSelected(){return this.items.filter(t=>t.selected).length>0}onQtyBulkAdjSubmit(){const t=[];this.items.forEach(e=>{e.selected&&t.push(e.id)}),this.service.updateQtyToZero({ids:t,reason:this.qtyBulkAdjustForm.controls.reason.value,comments:this.qtyBulkAdjustForm.controls.comments.value}).subscribe(t=>{this.fetchStock(),this.qtyBulkAdjustForm.reset(),this.displayQtyBulkAdjForm=!1})}onQtyChange(t){this.finalqty=this.selectedItem.available-1*this.qtyAdjustForm.controls.qty.value*-1}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(j.q),T.Y36(S.q),T.Y36(I.m))},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:76,vars:29,consts:[[1,"row","mt-2"],[1,"col-12"],["type","checkbox","name","available","id","available",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","available",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],["type","checkbox","name","expired","id","expired",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","expired",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],[1,"btn","btn-outline-success",3,"disabled","click"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["header","Stock Adjustment",3,"visible","modal","visibleChange"],[3,"formGroup","ngSubmit"],[1,"container"],[1,"row"],[1,"col-12","p-0"],[1,"batch"],[1,"col-md-2","m-0","p-0"],["for","price",1,"adj-label"],["for","qty",1,"adj-label"],["type","number","id","qty","formControlName","qty",1,"form-control",3,"min","input"],[1,"col-md-2"],["for","newqty",1,"adj-label"],[1,"col-md-3","m-0","p-0"],["for","reason",1,"adj-label"],["formControlName","reason",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","p-0"],["for","comments",1,"adj-label"],["id","comments","placeholder","Explain the reason for adjustment","formControlName","comments",1,"form-control"],[1,"row","mt-3"],["type","submit",1,"btn","btn-primary",3,"disabled"],["header","Bulk Adjustment",3,"visible","modal","visibleChange"],["type","checkbox",1,"form-conrol-input","checkmark",3,"change"],["pSortableColumn","invoice_no"],["type","text","field","invoice_no","display","menu"],["field","invoice_no"],["pSortableColumn","product_title"],["type","text","field","product_title","display","menu"],["field","product_title"],["pSortableColumn","product_expdate"],["field","product_expdate"],["pSortableColumn","available"],["type","numeric","field","available","display","menu"],["field","available"],["type","checkbox",1,"form-conrol-input","checkmark",3,"checked","change"],[3,"routerLink"],[1,"text-end"],[1,"text-center"],[1,"ml-2"],["href","javascript:void(0)",3,"click"],[1,"bi","bi-pencil-square","text-primary"],[3,"value"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T.TgZ(2,"input",2),T.NdJ("ngModelChange",function(t){return e.available=t})("change",function(){return e.fetchStock()}),T.qZA(),T.TgZ(3,"label",3),T._uU(4,"Available"),T.qZA(),T.TgZ(5,"input",4),T.NdJ("ngModelChange",function(t){return e.expired=t})("change",function(){return e.fetchStock()}),T.qZA(),T.TgZ(6,"label",5),T._uU(7,"Expired"),T.qZA(),T.qZA(),T.TgZ(8,"div",1),T.TgZ(9,"button",6),T.NdJ("click",function(){return e.complete()}),T._uU(10,"Complete"),T.qZA(),T._uU(11,"\xa0\xa0 "),T.qZA(),T.TgZ(12,"div",1),T.TgZ(13,"p-table",7,8),T.YNc(15,W,26,0,"ng-template",9),T.YNc(16,tt,27,15,"ng-template",10),T.qZA(),T.qZA(),T.qZA(),T.TgZ(17,"p-dialog",11),T.NdJ("visibleChange",function(t){return e.displayQtyAdjForm=t}),T.TgZ(18,"form",12),T.NdJ("ngSubmit",function(){return e.onQtyAdjSubmit()}),T.TgZ(19,"div",13),T.TgZ(20,"div",14),T.TgZ(21,"div",15),T.TgZ(22,"h5"),T._uU(23),T.qZA(),T.TgZ(24,"p",16),T._uU(25),T.ALo(26,"date"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(27,"div",14),T.TgZ(28,"div",17),T.TgZ(29,"label",18),T._uU(30,"Current"),T.qZA(),T._UZ(31,"br"),T._uU(32),T.qZA(),T.TgZ(33,"div",17),T.TgZ(34,"label",19),T._uU(35,"Adjust"),T.qZA(),T.TgZ(36,"input",20),T.NdJ("input",function(t){return e.onQtyChange(t)}),T.qZA(),T.qZA(),T.TgZ(37,"div",21),T.TgZ(38,"label",22),T._uU(39,"Final"),T.qZA(),T._UZ(40,"br"),T._uU(41),T.qZA(),T.TgZ(42,"div",23),T.TgZ(43,"label",24),T._uU(44,"Reason"),T.qZA(),T.TgZ(45,"select",25),T.TgZ(46,"option",26),T._uU(47,"Select"),T.qZA(),T.YNc(48,et,2,2,"option",27),T.qZA(),T.qZA(),T.TgZ(49,"div",28),T.TgZ(50,"label",29),T._uU(51,"Comments"),T.qZA(),T._UZ(52,"textarea",30),T.qZA(),T.qZA(),T.TgZ(53,"div",31),T.TgZ(54,"div",28),T.TgZ(55,"button",32),T._uU(56,"Save"),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.TgZ(57,"p-dialog",33),T.NdJ("visibleChange",function(t){return e.displayQtyBulkAdjForm=t}),T.TgZ(58,"form",12),T.NdJ("ngSubmit",function(){return e.onQtyBulkAdjSubmit()}),T.TgZ(59,"div",13),T.TgZ(60,"div",14),T.TgZ(61,"div",1),T.TgZ(62,"label",24),T._uU(63,"Reason"),T.qZA(),T.TgZ(64,"select",25),T.TgZ(65,"option",26),T._uU(66,"Select"),T.qZA(),T.YNc(67,it,2,2,"option",27),T.qZA(),T.qZA(),T.TgZ(68,"div",1),T.TgZ(69,"label",29),T._uU(70,"Comments"),T.qZA(),T._UZ(71,"textarea",30),T.qZA(),T.qZA(),T.TgZ(72,"div",31),T.TgZ(73,"div",28),T.TgZ(74,"button",32),T._uU(75,"Save"),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.qZA()),2&t&&(T.xp6(2),T.Q6J("ngModel",e.available),T.xp6(3),T.Q6J("ngModel",e.expired),T.xp6(4),T.Q6J("disabled",!e.isItemsSelected()),T.xp6(4),T.Q6J("value",e.items)("resizableColumns",!0)("paginator",!0)("rows",25)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(28,nt)),T.xp6(4),T.Q6J("visible",e.displayQtyAdjForm)("modal",!0),T.xp6(1),T.Q6J("formGroup",e.qtyAdjustForm),T.xp6(5),T.Oqu(null==e.selectedItem?null:e.selectedItem.product_title),T.xp6(2),T.AsE("",null==e.selectedItem?null:e.selectedItem.product_batch," / ",T.xi3(26,25,null==e.selectedItem?null:e.selectedItem.product_expdate,"MMM-yy"),""),T.xp6(7),T.hij(" ",null==e.selectedItem?null:e.selectedItem.available," "),T.xp6(4),T.Q6J("min",e.minAllowed),T.xp6(5),T.hij(" ",e.finalqty," "),T.xp6(7),T.Q6J("ngForOf",e.qtyChangeReasons),T.xp6(7),T.Q6J("disabled",!e.qtyAdjustForm.valid),T.xp6(2),T.Q6J("visible",e.displayQtyBulkAdjForm)("modal",!0),T.xp6(1),T.Q6J("formGroup",e.qtyBulkAdjustForm),T.xp6(9),T.Q6J("ngForOf",e.qtyChangeReasons),T.xp6(7),T.Q6J("disabled",!e.qtyBulkAdjustForm.valid))},directives:[o.Wl,o.JJ,o.On,u.iA,Q.jx,c.V,o._Y,o.JL,o.sg,o.wV,o.qQ,o.Fj,o.u,o.EJ,o.YN,o.Kr,n.sg,u.lQ,u.xl,u.fz,r.yS],pipes:[n.uU],styles:[".adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t})(),rt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&T._UZ(0,"router-outlet")},directives:[r.lC],encapsulation:2}),t})();var at=i(9765),lt=i(2340),st=i(1841);let ct=(()=>{class t{constructor(t){this.http=t,this.products=new at.xQ,this.stats=new at.xQ,this.apiurl=lt.N.apiHost+"/stock2"}getProducts(){return this.products}getProductStats(){return this.stats}refreshProducts(){this.findAll(this.filter)}findAll(t){this.filter=t,this.http.post(this.apiurl,this.filter).subscribe(t=>{this.products.next(t)})}findByProduct(t){this.http.get(`${this.apiurl}/${t}`).subscribe(t=>{this.stats.next(t)})}}return t.\u0275fac=function(e){return new(e||t)(T.LFG(st.eN))},t.\u0275prov=T.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function ut(t,e){1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"th",10),T._uU(2,"Product "),T._UZ(3,"p-columnFilter",11),T._UZ(4,"p-sortIcon",12),T.qZA(),T.TgZ(5,"th",13),T._uU(6,"Last "),T._UZ(7,"p-sortIcon",14),T.qZA(),T.TgZ(8,"th"),T._uU(9,"Cust."),T.qZA(),T.TgZ(10,"th"),T._uU(11,"Avg."),T._UZ(12,"br"),T._uU(13,"Sales"),T.qZA(),T.TgZ(14,"th"),T._uU(15,"High"),T._UZ(16,"br"),T._uU(17,"Sales"),T.qZA(),T.TgZ(18,"th",15),T._uU(19,"Avail "),T._UZ(20,"p-sortIcon",16),T.qZA(),T.TgZ(21,"th",17),T._uU(22,"Level "),T._UZ(23,"p-sortIcon",18),T.qZA(),T.qZA())}const dt=function(t){return{low:t}};function pt(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr",19),T.NdJ("click",function(){const e=T.CHM(t).$implicit;return T.oxw().openData(e.id)}),T.TgZ(1,"td"),T._uU(2),T.qZA(),T.TgZ(3,"td"),T._uU(4),T.ALo(5,"date"),T.qZA(),T.TgZ(6,"td"),T._uU(7),T.qZA(),T.TgZ(8,"td"),T._uU(9),T.ALo(10,"number"),T.qZA(),T.TgZ(11,"td"),T._uU(12),T.qZA(),T.TgZ(13,"td",20),T.TgZ(14,"strong"),T._uU(15),T.qZA(),T.qZA(),T.TgZ(16,"td"),T._uU(17),T.qZA(),T.qZA()}if(2&t){const t=e.$implicit;T.Q6J("ngClass",T.VKq(14,dt,t.level<20)),T.xp6(2),T.hij("",t.title," "),T.xp6(2),T.Oqu(T.xi3(5,8,t.last_sale_date,"MM/yy")),T.xp6(3),T.Oqu(t.highest_customers),T.xp6(2),T.Oqu(T.xi3(10,11,t.average_sales,"1.0-0")),T.xp6(3),T.Oqu(t.highest_sales),T.xp6(3),T.Oqu(t.balance),T.xp6(2),T.Oqu(t.level)}}const Zt=function(){return[10,25,50]};let gt=(()=>{class t{constructor(t,e,i){this.router=t,this.activatedRoute=e,this.service=i,this.criteria={active:!0,available:!1,expired:!1,starts:!0},this.products=[]}ngOnInit(){this.service.findAll({criteria:this.criteria}),this.service.getProducts().subscribe(t=>{this.products=t})}fetch(){this.service.findAll({criteria:this.criteria})}openData(t){this.router.navigate(["items",t],{relativeTo:this.activatedRoute})}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(r.F0),T.Y36(r.gz),T.Y36(ct))},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:19,vars:9,consts:[[1,"row","mt-2"],[1,"col-12"],[1,"d-flex"],["type","checkbox",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","available",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],["for","expired",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],[1,"col-6"],["styleClass","p-datatable-gridlines p-datatable-sm","currentPageReportTemplate","{totalRecords} Products",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","title"],["type","text","field","title","display","menu"],["field","title"],["pSortableColumn","last_sale_date"],["field","last_sale_date"],["pSortableColumn","balance"],["field","balance"],["pSortableColumn","level"],["field","level"],[1,"row-hover",3,"ngClass","click"],[1,"text-end"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T.TgZ(2,"div",2),T.TgZ(3,"input",3),T.NdJ("ngModelChange",function(t){return e.criteria.active=t})("change",function(){return e.fetch()}),T.qZA(),T.TgZ(4,"label",4),T._uU(5,"Active"),T.qZA(),T.TgZ(6,"input",3),T.NdJ("ngModelChange",function(t){return e.criteria.available=t})("change",function(){return e.fetch()}),T.qZA(),T.TgZ(7,"label",5),T._uU(8,"Available"),T.qZA(),T.TgZ(9,"input",3),T.NdJ("ngModelChange",function(t){return e.criteria.expired=t})("change",function(){return e.fetch()}),T.qZA(),T.TgZ(10,"label",5),T._uU(11,"Expired"),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.TgZ(12,"div",0),T.TgZ(13,"div",6),T.TgZ(14,"p-table",7),T.YNc(15,ut,24,0,"ng-template",8),T.YNc(16,pt,18,16,"ng-template",9),T.qZA(),T.qZA(),T.TgZ(17,"div",6),T._UZ(18,"router-outlet"),T.qZA(),T.qZA()),2&t&&(T.xp6(3),T.Q6J("ngModel",e.criteria.active),T.xp6(3),T.Q6J("ngModel",e.criteria.available),T.xp6(3),T.Q6J("ngModel",e.criteria.expired),T.xp6(5),T.Q6J("value",e.products)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(8,Zt)))},directives:[o.Wl,o.JJ,o.On,u.iA,Q.jx,r.lC,u.lQ,u.xl,u.fz,n.mk],pipes:[n.uU,n.JJ],encapsulation:2}),t})();var mt=i(1129);function ht(t,e){if(1&t&&(T.TgZ(0,"option",21),T._uU(1),T.qZA()),2&t){const t=e.$implicit;T.Q6J("value",t.value),T.xp6(1),T.Oqu(t.label)}}let qt=(()=>{class t{constructor(t){this.service=t,this.item={},this.saved=new T.vpe,this.finalqty=0,this.maxAllowed=0,this.minAllowed=0,this.qtyAdjustForm=new o.cw({itemid:new o.NI("",o.kI.required),reason:new o.NI("",o.kI.required),qty:new o.NI(0,o.kI.required),comments:new o.NI("")}),this.qtyChangeReasons=[{value:"Damaged",label:"Damaged"},{value:"Missing",label:"Missing"},{value:"Expired",label:"Expired"},{value:"Other",label:"Other"}]}ngOnChanges(t){t.item.currentValue&&(console.log(t.item.currentValue),this.qtyAdjustForm.reset(),this.qtyAdjustForm.controls.itemid.setValue(this.item.item_id),this.finalqty=this.item.balance,this.minAllowed=-1*+this.item.balance)}onQtyChange(t){this.finalqty=this.item.balance-1*this.qtyAdjustForm.controls.qty.value*-1}onQtyAdjSubmit(){this.service.updateQty(this.qtyAdjustForm.value).subscribe(t=>{this.saved.emit(t)})}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(j.q))},t.\u0275cmp=T.Xpm({type:t,selectors:[["app-stock-adjust-form"]],inputs:{item:"item"},outputs:{saved:"saved"},features:[T.TTD],decls:39,vars:12,consts:[[3,"formGroup","ngSubmit"],[1,"container"],[1,"row"],[1,"col-12","p-0"],[1,"batch"],[1,"col-md-2","m-0","p-0"],["for","price",1,"adj-label"],["for","qty",1,"adj-label"],["type","number","id","qty","formControlName","qty",1,"form-control",3,"min","input"],[1,"col-md-2"],["for","newqty",1,"adj-label"],[1,"col-md-3","m-0","p-0"],["for","reason",1,"adj-label"],["formControlName","reason",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","p-0"],["for","comments",1,"adj-label"],["id","comments","placeholder","Explain the reason for adjustment","formControlName","comments",1,"form-control"],[1,"row","mt-3"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(T.TgZ(0,"form",0),T.NdJ("ngSubmit",function(){return e.onQtyAdjSubmit()}),T.TgZ(1,"div",1),T.TgZ(2,"div",2),T.TgZ(3,"div",3),T.TgZ(4,"h5"),T._uU(5),T.qZA(),T.TgZ(6,"p",4),T._uU(7),T.ALo(8,"date"),T.qZA(),T.qZA(),T.qZA(),T.TgZ(9,"div",2),T.TgZ(10,"div",5),T.TgZ(11,"label",6),T._uU(12,"Current"),T.qZA(),T._UZ(13,"br"),T._uU(14),T.qZA(),T.TgZ(15,"div",5),T.TgZ(16,"label",7),T._uU(17,"Adjust"),T.qZA(),T.TgZ(18,"input",8),T.NdJ("input",function(t){return e.onQtyChange(t)}),T.qZA(),T.qZA(),T.TgZ(19,"div",9),T.TgZ(20,"label",10),T._uU(21,"Final"),T.qZA(),T._UZ(22,"br"),T._uU(23),T.qZA(),T.TgZ(24,"div",11),T.TgZ(25,"label",12),T._uU(26,"Reason"),T.qZA(),T.TgZ(27,"select",13),T.TgZ(28,"option",14),T._uU(29,"Select"),T.qZA(),T.YNc(30,ht,2,2,"option",15),T.qZA(),T.qZA(),T.TgZ(31,"div",16),T.TgZ(32,"label",17),T._uU(33,"Comments"),T.qZA(),T._UZ(34,"textarea",18),T.qZA(),T.qZA(),T.TgZ(35,"div",19),T.TgZ(36,"div",16),T.TgZ(37,"button",20),T._uU(38,"Save"),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.qZA()),2&t&&(T.Q6J("formGroup",e.qtyAdjustForm),T.xp6(5),T.Oqu(null==e.item?null:e.item.title),T.xp6(2),T.AsE("",null==e.item?null:e.item.batch," / ",T.xi3(8,9,null==e.item?null:e.item.exp_date,"MMM-yy"),""),T.xp6(7),T.hij(" ",null==e.item?null:e.item.balance," "),T.xp6(4),T.Q6J("min",e.minAllowed),T.xp6(5),T.hij(" ",e.finalqty," "),T.xp6(7),T.Q6J("ngForOf",e.qtyChangeReasons),T.xp6(7),T.Q6J("disabled",!e.qtyAdjustForm.valid))},directives:[o._Y,o.JL,o.sg,o.wV,o.qQ,o.Fj,o.JJ,o.u,o.EJ,o.YN,o.Kr,n.sg],pipes:[n.uU],encapsulation:2}),t})();function At(t,e){1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"th"),T._uU(2,"Date"),T.qZA(),T.TgZ(3,"th"),T._uU(4,"Inv No."),T.qZA(),T.TgZ(5,"th"),T._uU(6,"Batch"),T.qZA(),T.TgZ(7,"th"),T._uU(8,"Exp Date"),T.qZA(),T.TgZ(9,"th"),T._uU(10,"Buy"),T.qZA(),T.TgZ(11,"th"),T._uU(12,"Sel"),T.qZA(),T.TgZ(13,"th"),T._uU(14,"Adj"),T.qZA(),T.TgZ(15,"th"),T._uU(16,"Bal"),T.qZA(),T._UZ(17,"th"),T.qZA())}const ft=function(t){return{expired:t}};function vt(t,e){if(1&t){const t=T.EpF();T.TgZ(0,"tr",13),T.TgZ(1,"td"),T._uU(2),T.ALo(3,"date"),T.qZA(),T.TgZ(4,"td"),T._uU(5),T.qZA(),T.TgZ(6,"td"),T._uU(7),T.qZA(),T.TgZ(8,"td"),T._uU(9),T.ALo(10,"date"),T.qZA(),T.TgZ(11,"td",14),T._uU(12),T.qZA(),T.TgZ(13,"td",14),T._uU(14),T.qZA(),T.TgZ(15,"td",14),T._uU(16),T.qZA(),T.TgZ(17,"td",14),T._uU(18),T.qZA(),T.TgZ(19,"td"),T.TgZ(20,"h5",15),T.TgZ(21,"a",16),T.NdJ("click",function(){const e=T.CHM(t).$implicit;return T.oxw().showQtyDialog(e)}),T._UZ(22,"i",17),T.qZA(),T.qZA(),T.qZA(),T.qZA()}if(2&t){const t=e.$implicit;T.Q6J("ngClass",T.VKq(15,ft,1==t.expired)),T.xp6(2),T.Oqu(T.xi3(3,9,t.invoice_date,"dd/MM/yy")),T.xp6(3),T.Oqu(t.invoice_no),T.xp6(2),T.Oqu(t.batch),T.xp6(2),T.Oqu(T.xi3(10,12,t.exp_date,"MMM-yy")),T.xp6(3),T.Oqu(t.purchased),T.xp6(2),T.Oqu(t.sold),T.xp6(2),T.Oqu(t.adjusted),T.xp6(2),T.Oqu(t.balance)}}function Tt(t,e){1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"th"),T._uU(2,"Month"),T.qZA(),T.TgZ(3,"th"),T._uU(4,"Orders"),T.qZA(),T.TgZ(5,"th"),T._uU(6,"Qty"),T.qZA(),T.qZA())}function _t(t,e){if(1&t&&(T.TgZ(0,"tr",13),T.TgZ(1,"td"),T._uU(2),T.ALo(3,"date"),T.qZA(),T.TgZ(4,"td",14),T._uU(5),T.qZA(),T.TgZ(6,"td",14),T._uU(7),T.qZA(),T.qZA()),2&t){const t=e.$implicit;T.Q6J("ngClass",T.VKq(7,ft,1==t.long)),T.xp6(2),T.Oqu(T.xi3(3,4,t.sale_month,"MMM-yy")),T.xp6(3),T.Oqu(t.total_orders),T.xp6(2),T.Oqu(t.total_qty)}}function bt(t,e){1&t&&(T.TgZ(0,"tr"),T.TgZ(1,"th"),T._uU(2,"Month"),T.qZA(),T.TgZ(3,"th"),T._uU(4,"Name"),T.qZA(),T.TgZ(5,"th"),T._uU(6,"Mobile"),T.qZA(),T.TgZ(7,"th",14),T._uU(8,"Qty"),T.qZA(),T.TgZ(9,"th",14),T._uU(10,"Last Sold"),T.qZA(),T.qZA())}function yt(t,e){if(1&t&&(T.TgZ(0,"tr",13),T.TgZ(1,"td"),T._uU(2),T.ALo(3,"date"),T.qZA(),T.TgZ(4,"td"),T._uU(5),T.qZA(),T.TgZ(6,"td"),T._uU(7),T.qZA(),T.TgZ(8,"td",14),T._uU(9),T.qZA(),T.TgZ(10,"td",14),T._uU(11),T.ALo(12,"date"),T.qZA(),T.qZA()),2&t){const t=e.$implicit;T.Q6J("ngClass",T.VKq(11,ft,1==t.long)),T.xp6(2),T.Oqu(T.xi3(3,6,t.sale_month,"MMM-yy")),T.xp6(3),T.Oqu(t.name),T.xp6(2),T.Oqu(t.mobile),T.xp6(2),T.Oqu(t.total_qty),T.xp6(2),T.Oqu(T.lcZ(12,9,t.recent))}}const xt=function(t,e){return{"btn-outline-danger":t,"btn-outline-success":e}},Ut=function(){return[10,25,50]},kt=[{path:"",component:w,canActivate:[a.a],children:[{path:"",redirectTo:"stock"},{path:"stock",component:M,children:[{path:"",redirectTo:"list"},{path:"list",component:L},{path:"audit",component:ot},{path:"adjust",component:B},{path:"demand",component:H}]},{path:"inventory",component:rt,children:[{path:"",redirectTo:"products"},{path:"products",component:gt,children:[{path:"items/:id",component:(()=>{class t{constructor(t,e,i){this.route=t,this.service=e,this.prodService=i,this.data={},this.product={},this.displayQtyAdjForm=!1}ngOnInit(){this.route.params.subscribe(t=>{this.service.findByProduct(t.id),this.service.getProductStats().subscribe(t=>{t.purchases.length>0&&(this.product=t.purchases[0]),t.sales.forEach(t=>{t.long=this.isAfterDays(t.sale_month,180)}),t.customers.forEach(t=>{t.long=this.isAfterDays(t.sale_month,180)}),this.data=t})})}isAfterDays(t,e){const i=new Date(t).getTime();return((new Date).getTime()-i)/1e3/60/60/24>e}showQtyDialog(t){this.selectedItem=t,this.displayQtyAdjForm=!0}closeAdjForm(t){this.displayQtyAdjForm=!1,this.service.findByProduct(this.selectedItem.id),this.service.refreshProducts()}toggleActive(t){this.prodService.update(t.id,{isActive:!t.active}).subscribe(e=>{1==e.affected&&(this.product.active=!t.active)})}}return t.\u0275fac=function(e){return new(e||t)(T.Y36(r.gz),T.Y36(ct),T.Y36(mt.s))},t.\u0275cmp=T.Xpm({type:t,selectors:[["ng-component"]],decls:25,vars:27,consts:[[1,"row"],[1,"col-12"],[1,"col-10","d-flex"],[1,"col-2","d-flex","text-end"],[1,"btn","btn-sm",3,"ngClass","click"],["header","Purchase"],["styleClass","p-datatable-gridlines p-datatable-sm","currentPageReportTemplate","{totalRecords} Items",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["header","Sale"],["header","Customer"],["header","Stock Adjustment",3,"visible","modal","visibleChange"],[3,"item","saved"],[3,"ngClass"],[2,"text-align","right"],[1,"icon"],["href","javascript:void(0)",3,"click"],[1,"bi","bi-pencil-square","text-primary"]],template:function(t,e){1&t&&(T.TgZ(0,"div",0),T.TgZ(1,"div",1),T.TgZ(2,"div",2),T.TgZ(3,"h5"),T._uU(4),T.qZA(),T.qZA(),T.TgZ(5,"div",3),T.TgZ(6,"button",4),T.NdJ("click",function(){return e.toggleActive(e.product)}),T.TgZ(7,"span"),T._uU(8),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.TgZ(9,"p-tabView"),T.TgZ(10,"p-tabPanel",5),T.TgZ(11,"div",1),T.TgZ(12,"p-table",6),T.YNc(13,At,18,0,"ng-template",7),T.YNc(14,vt,23,17,"ng-template",8),T.qZA(),T.qZA(),T.qZA(),T.TgZ(15,"p-tabPanel",9),T.TgZ(16,"p-table",6),T.YNc(17,Tt,7,0,"ng-template",7),T.YNc(18,_t,8,9,"ng-template",8),T.qZA(),T.qZA(),T.TgZ(19,"p-tabPanel",10),T.TgZ(20,"p-table",6),T.YNc(21,bt,11,0,"ng-template",7),T.YNc(22,yt,13,13,"ng-template",8),T.qZA(),T.qZA(),T.qZA(),T.qZA(),T.TgZ(23,"p-dialog",11),T.NdJ("visibleChange",function(t){return e.displayQtyAdjForm=t}),T.TgZ(24,"app-stock-adjust-form",12),T.NdJ("saved",function(t){return e.closeAdjForm(t)}),T.qZA(),T.qZA()),2&t&&(T.xp6(4),T.Oqu(e.product.title),T.xp6(2),T.Q6J("ngClass",T.WLB(21,xt,e.product.active,!e.product.active)),T.xp6(2),T.Oqu(e.product.active?"Disable":"Enable"),T.xp6(4),T.Q6J("value",e.data.purchases)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(24,Ut)),T.xp6(4),T.Q6J("value",e.data.sales)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(25,Ut)),T.xp6(4),T.Q6J("value",e.data.customers)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",T.DdM(26,Ut)),T.xp6(3),T.Q6J("visible",e.displayQtyAdjForm)("modal",!0),T.xp6(1),T.Q6J("item",e.selectedItem))},directives:[n.mk,A.xf,A.x4,u.iA,Q.jx,c.V,qt],pipes:[n.uU],encapsulation:2}),t})()}]}]},{path:"cash",component:C},{path:"credit",component:K}]}];let wt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=T.oAB({type:t}),t.\u0275inj=T.cJS({imports:[[r.Bz.forChild(kt),o.u5,n.ez,o.UX,s.WN,p._8,c.S,u.U$,d.EV,A.LU,Z.JH,g.q4,m.vI,h.hJ,q.kW,f.q,v.j,l.m],r.Bz]}),t})()}}]);