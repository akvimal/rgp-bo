!function(){"use strict";function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[695],{5695:function(t,n,o){o.r(n),o.d(n,{StoreModule:function(){return Mt}});var r=o(8583),a=o(665),l=o(8288),u=o(2561),c=o(4466),s=o(6516),d=o(5121),p=o(7872),Z=o(7965),g=o(8598),m=o(7564),h=o(6949),f=o(1526),q=o(4207),A=o(103),v=o(4748),T=o(8220),b=o(3928),_=o(7716),y=o(2777),x=function(){return["is-active"]};function U(t,e){1&t&&(_.TgZ(0,"li",4),_.TgZ(1,"a",5),_._uU(2,"Stock"),_.qZA(),_.qZA()),2&t&&(_.xp6(1),_.Q6J("routerLinkActive",_.DdM(1,x)))}function k(t,e){1&t&&(_.TgZ(0,"li",4),_.TgZ(1,"a",6),_._uU(2,"Stock 2"),_.qZA(),_.qZA()),2&t&&(_.xp6(1),_.Q6J("routerLinkActive",_.DdM(1,x)))}function w(t,e){1&t&&(_.TgZ(0,"li",4),_.TgZ(1,"a",7),_._uU(2,"Cash"),_.qZA(),_.qZA()),2&t&&(_.xp6(1),_.Q6J("routerLinkActive",_.DdM(1,x)))}function C(t,e){1&t&&(_.TgZ(0,"li",4),_.TgZ(1,"a",8),_._uU(2,"Credit"),_.qZA(),_.qZA()),2&t&&(_.xp6(1),_.Q6J("routerLinkActive",_.DdM(1,x)))}var O,M=((O=e(function t(){i(this,t)})).\u0275fac=function(t){return new(t||O)},O.\u0275cmp=_.Xpm({type:O,selectors:[["ng-component"]],decls:10,vars:0,consts:[[1,"pagetitle"],[1,"page-menu","navbar","navbar-light","bg-light","justify-content-between","non-print","m-0","p-0"],[1,"nav"],["class","nav-item",4,"isNavAuth"],[1,"nav-item"],["routerLink","stock",1,"nav-link",3,"routerLinkActive"],["routerLink","inventory",1,"nav-link",3,"routerLinkActive"],["routerLink","cash",1,"nav-link",3,"routerLinkActive"],["routerLink","credit",1,"nav-link",3,"routerLinkActive"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"h1"),_._uU(2,"Store"),_.qZA(),_.qZA(),_.TgZ(3,"nav",1),_.TgZ(4,"ul",2),_.YNc(5,U,3,2,"li",3),_.YNc(6,k,3,2,"li",3),_.YNc(7,w,3,2,"li",3),_.YNc(8,C,3,2,"li",3),_.qZA(),_.qZA(),_._UZ(9,"router-outlet"))},directives:[y.x,l.lC,l.yS,l.Od],encapsulation:2}),O),j=function(){var t=e(function t(){i(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&_._uU(0," Cash Component\n")},encapsulation:2}),t}(),S=function(){return["is-active"]},I=function(){var t=e(function t(){i(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:15,vars:8,consts:[[1,"navbar","navbar-light","bg-light","justify-content-between","m-0","p-0"],[1,"nav"],[1,"nav-item"],["routerLink","list",1,"nav-link",3,"routerLinkActive"],["routerLink","audit",1,"nav-link",3,"routerLinkActive"],["routerLink","adjust",1,"nav-link",3,"routerLinkActive"],["routerLink","demand",1,"nav-link",3,"routerLinkActive"]],template:function(t,e){1&t&&(_.TgZ(0,"nav",0),_.TgZ(1,"ul",1),_.TgZ(2,"li",2),_.TgZ(3,"a",3),_._uU(4,"Inventory"),_.qZA(),_.qZA(),_.TgZ(5,"li",2),_.TgZ(6,"a",4),_._uU(7,"Audit"),_.qZA(),_.qZA(),_.TgZ(8,"li",2),_.TgZ(9,"a",5),_._uU(10,"Adjustments"),_.qZA(),_.qZA(),_.TgZ(11,"li",2),_.TgZ(12,"a",6),_._uU(13,"Demand"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_._UZ(14,"router-outlet")),2&t&&(_.xp6(3),_.Q6J("routerLinkActive",_.DdM(4,S)),_.xp6(3),_.Q6J("routerLinkActive",_.DdM(5,S)),_.xp6(3),_.Q6J("routerLinkActive",_.DdM(6,S)),_.xp6(3),_.Q6J("routerLinkActive",_.DdM(7,S)))},directives:[l.yS,l.Od,l.lC],encapsulation:2}),t}(),J=o(2912),Q=o(5414),N=o(139),F=o(6391),P=o(3013);function D(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"th"),_.TgZ(2,"input",13),_.NdJ("change",function(t){return _.CHM(i),_.oxw().selectAllItem(t)}),_.qZA(),_.qZA(),_.TgZ(3,"th",14),_._uU(4,"Invoice No "),_._UZ(5,"p-columnFilter",15),_._UZ(6,"p-sortIcon",16),_.qZA(),_.TgZ(7,"th",17),_._uU(8,"Product "),_._UZ(9,"p-columnFilter",18),_._UZ(10,"p-sortIcon",19),_.qZA(),_.TgZ(11,"th",20),_._uU(12,"Expiry "),_._UZ(13,"p-sortIcon",21),_.qZA(),_.TgZ(14,"th"),_._uU(15,"Purchased"),_.qZA(),_.TgZ(16,"th",22),_._uU(17,"Sold "),_._UZ(18,"p-columnFilter",23),_._UZ(19,"p-sortIcon",24),_.qZA(),_.TgZ(20,"th"),_._uU(21,"Adjusted"),_.qZA(),_.TgZ(22,"th",25),_._uU(23,"Available "),_._UZ(24,"p-columnFilter",26),_._UZ(25,"p-sortIcon",27),_.qZA(),_.TgZ(26,"th"),_._uU(27,"Actions"),_.qZA(),_.qZA()}}var L=function(t){return["/secure/purchases/items",t]};function Y(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"input",28),_.NdJ("change",function(t){var e=_.CHM(i).$implicit;return _.oxw().selectItem(t,e.id)}),_.qZA(),_.qZA(),_.TgZ(3,"td"),_.TgZ(4,"a",29),_._uU(5),_.qZA(),_.qZA(),_.TgZ(6,"td"),_.TgZ(7,"p",30),_._uU(8),_.qZA(),_.TgZ(9,"span",31),_._uU(10),_.qZA(),_.qZA(),_.TgZ(11,"td"),_._uU(12),_.ALo(13,"date"),_.qZA(),_.TgZ(14,"td",32),_._uU(15),_.qZA(),_.TgZ(16,"td",32),_._uU(17),_.qZA(),_.TgZ(18,"td",32),_._uU(19),_.qZA(),_.TgZ(20,"td",32),_._uU(21),_.qZA(),_._UZ(22,"td",33),_.qZA()}if(2&t){var n=e.$implicit;_.xp6(2),_.Q6J("checked",n.selected),_.xp6(2),_.Q6J("routerLink",_.VKq(13,L,n.purchase_invoiceid)),_.xp6(1),_.Oqu(n.invoice_no),_.xp6(3),_.Oqu(n.product_title),_.xp6(2),_.Oqu(n.product_batch),_.xp6(2),_.Oqu(_.xi3(13,10,n.product_expdate,"MMM-yy")),_.xp6(3),_.Oqu(n.purchased),_.xp6(2),_.Oqu(n.sold),_.xp6(2),_.Oqu(n.adjusted),_.xp6(2),_.Oqu(n.available)}}var R=function(){return[25,50,100]},E=function(){var t=function(){function t(e,n,o){i(this,t),this.service=e,this.invoiceService=n,this.dateService=o,this.items=[],this.displayQtyAdjForm=!1,this.selectedItem={},this.finalqty=0,this.maxAllowed=0,this.minAllowed=0,this.available=!0,this.expired=!1,this.inactive=!1,this.qtyAdjustForm=new a.cw({itemid:new a.NI("",a.kI.required),reason:new a.NI("Other",a.kI.required),qty:new a.NI(0,a.kI.required),comments:new a.NI("")}),this.qtyChangeReasons=[{value:"Damaged",label:"Damaged"},{value:"Missing",label:"Missing"},{value:"Expired",label:"Expired"},{value:"Other",label:"Other"}]}return e(t,[{key:"ngOnInit",value:function(){this.fetchStock()}},{key:"fetchStock",value:function(){var t=this;this.service.filterByCriteria({status:"VERIFIED",id:this.selectedItem.id,title:this.selectedItem.title,available:this.available,expired:this.expired,starts:!0}).subscribe(function(e){t.items=e.map(function(t){return Object.assign(Object.assign({},t),{available:+t.available})})})}},{key:"selectItem",value:function(t,e){this.items.forEach(function(t){t.id==e&&(t.selected=!0)})}},{key:"selectAllItem",value:function(t){this.items.forEach(function(e){e.selected=t.target.checked})}},{key:"isItemsSelected",value:function(){return this.items.filter(function(t){return t.selected}).length>0}},{key:"onProductSelect",value:function(t){this.selectedItem=t,this.fetchStock()}},{key:"audit",value:function(){var t=this,e=[];this.items.forEach(function(t){t.selected&&e.push(t.id)}),this.invoiceService.updateItems(e,{status:"AUDIT",verifystartdate:this.dateService.getFormatDate(new Date)}).subscribe(function(e){return t.fetchStock()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(J.q),_.Y36(Q.q),_.Y36(N.m))},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:18,vars:10,consts:[[1,"row","mt-2"],[1,"col-12"],[1,"d-flex"],["type","checkbox","name","available","id","available",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","available",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],["type","checkbox","name","expired","id","expired",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","expired",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],[3,"selected"],[1,"btn","btn-outline-info",3,"disabled","click"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["type","checkbox",1,"form-conrol-input","checkmark",3,"change"],["pSortableColumn","invoice_no"],["type","text","field","invoice_no","display","menu"],["field","invoice_no"],["pSortableColumn","product_title"],["type","text","field","product_title","display","menu"],["field","product_title"],["pSortableColumn","product_expdate"],["field","product_expdate"],["pSortableColumn","sold"],["type","numeric","field","sold","display","menu"],["field","sold"],["pSortableColumn","available"],["type","numeric","field","available","display","menu"],["field","available"],["type","checkbox",1,"form-conrol-input","checkmark",3,"checked","change"],[3,"routerLink"],[1,"m-0"],[1,"batch"],[1,"text-end"],[1,"text-center"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_.TgZ(3,"input",3),_.NdJ("ngModelChange",function(t){return e.available=t})("change",function(){return e.fetchStock()}),_.qZA(),_.TgZ(4,"label",4),_._uU(5,"Available"),_.qZA(),_.TgZ(6,"input",5),_.NdJ("ngModelChange",function(t){return e.expired=t})("change",function(){return e.fetchStock()}),_.qZA(),_.TgZ(7,"label",6),_._uU(8,"Expired"),_.qZA(),_.TgZ(9,"app-product-select",7),_.NdJ("selected",function(t){return e.onProductSelect(t)}),_.qZA(),_.qZA(),_.qZA(),_.TgZ(10,"div",1),_.TgZ(11,"button",8),_.NdJ("click",function(){return e.audit()}),_._uU(12,"Audit"),_.qZA(),_.qZA(),_.TgZ(13,"div",1),_.TgZ(14,"p-table",9,10),_.YNc(16,D,28,0,"ng-template",11),_.YNc(17,Y,23,15,"ng-template",12),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.xp6(3),_.Q6J("ngModel",e.available),_.xp6(3),_.Q6J("ngModel",e.expired),_.xp6(5),_.Q6J("disabled",!e.isItemsSelected()),_.xp6(3),_.Q6J("value",e.items)("resizableColumns",!0)("paginator",!0)("rows",25)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(9,R)))},directives:[a.Wl,a.JJ,a.On,F.q,p.iA,P.jx,p.lQ,p.xl,p.fz,l.yS],pipes:[r.uU],styles:[".adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t}();function z(t,e){1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"th",6),_._uU(2,"Product "),_._UZ(3,"p-columnFilter",7),_._UZ(4,"p-sortIcon",8),_.qZA(),_.TgZ(5,"th",9),_._uU(6,"Qty "),_._UZ(7,"p-sortIcon",10),_.qZA(),_.TgZ(8,"th",11),_._uU(9,"Date "),_._UZ(10,"p-columnFilter",12),_._UZ(11,"p-sortIcon",13),_.qZA(),_.TgZ(12,"th",14),_._uU(13,"Reason "),_._UZ(14,"p-sortIcon",15),_.qZA(),_.TgZ(15,"th"),_._uU(16,"Actions"),_.qZA(),_.qZA())}function B(t,e){1&t&&(_.TgZ(0,"h5",19),_._UZ(1,"i",22),_.qZA())}function V(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"p",16),_._uU(3),_.qZA(),_.TgZ(4,"span",17),_._uU(5),_.ALo(6,"date"),_.qZA(),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.TgZ(9,"td"),_._uU(10),_.ALo(11,"date"),_.qZA(),_.TgZ(12,"td"),_._uU(13),_.YNc(14,B,2,0,"h5",18),_.qZA(),_.TgZ(15,"td"),_.TgZ(16,"h5",19),_.TgZ(17,"a",20),_.NdJ("click",function(){var t=_.CHM(i).$implicit;return _.oxw().delete(t.id)}),_._UZ(18,"i",21),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&t){var n=e.$implicit;_.xp6(3),_.Oqu(n.title),_.xp6(2),_.AsE("",n.batch,"/",_.xi3(6,7,n.expdate,"MMM-yy"),""),_.xp6(3),_.Oqu(n.qty),_.xp6(2),_.Oqu(_.xi3(11,10,n.date,"dd/MM/yyyy")),_.xp6(3),_.hij("",n.reason," "),_.xp6(1),_.Q6J("ngIf",n.comments)}}var $=function(){return[10,25,50]},X=function(){var t=function(){function t(e){i(this,t),this.stockService=e,this.quantities=[]}return e(t,[{key:"ngOnInit",value:function(){this.fetchAdjustments()}},{key:"fetchAdjustments",value:function(){var t=this;this.stockService.findAllQtyAdjustments().subscribe(function(e){t.quantities=e})}},{key:"edit",value:function(t){}},{key:"delete",value:function(t){var e=this;this.stockService.deleteQtyAdjustment(t).subscribe(function(t){e.fetchAdjustments()})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(J.q))},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:6,vars:7,consts:[[1,"row","mt-2"],[1,"col-12"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt2",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","title"],["type","text","field","title","display","menu"],["field","title"],["pSortableColumn","qty"],["field","qty"],["pSortableColumn","date"],["type","date","field","date","display","menu"],["field","date"],["pSortableColumn","reason"],["field","reason"],[1,"m-0"],[1,"batch"],["style","float:left; margin-right: 0.3em;",4,"ngIf"],[2,"float","left","margin-right","0.3em"],[3,"click"],[1,"bi","bi-trash","text-danger"],[1,"bi","bi-chat","text-danger"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"p-table",2,3),_.YNc(4,z,17,0,"ng-template",4),_.YNc(5,V,19,13,"ng-template",5),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.xp6(2),_.Q6J("value",e.quantities)("resizableColumns",!0)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(6,$)))},directives:[p.iA,P.jx,p.lQ,p.xl,p.fz,r.O5],pipes:[r.uU],styles:[".adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t}();function H(t,e){1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"th",8),_._uU(2,"ID "),_._UZ(3,"p-columnFilter",9),_._UZ(4,"p-sortIcon",10),_.qZA(),_.TgZ(5,"th",11),_._uU(6,"Product "),_._UZ(7,"p-columnFilter",12),_._UZ(8,"p-sortIcon",13),_.qZA(),_.TgZ(9,"th",14),_._uU(10,"Order Since "),_._UZ(11,"p-columnFilter",15),_._UZ(12,"p-sortIcon",16),_.qZA(),_.TgZ(13,"th",17),_._uU(14,"Order Freq "),_._UZ(15,"p-columnFilter",18),_._UZ(16,"p-sortIcon",19),_.qZA(),_.TgZ(17,"th",20),_._uU(18,"Orders "),_._UZ(19,"p-sortIcon",21),_.qZA(),_.TgZ(20,"th",22),_._uU(21,"Sold Qty "),_._UZ(22,"p-sortIcon",23),_.qZA(),_.TgZ(23,"th",24),_._uU(24,"Avai Qty "),_._UZ(25,"p-sortIcon",25),_.qZA(),_.TgZ(26,"th",26),_._uU(27,"Start Date "),_._UZ(28,"p-columnFilter",27),_._UZ(29,"p-sortIcon",28),_.qZA(),_.TgZ(30,"th",29),_._uU(31,"Last Date "),_._UZ(32,"p-columnFilter",30),_._UZ(33,"p-sortIcon",31),_.qZA(),_.qZA())}function K(t,e){if(1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"td"),_._uU(2),_.qZA(),_.TgZ(3,"td"),_._uU(4),_.qZA(),_.TgZ(5,"td"),_._uU(6),_.qZA(),_.TgZ(7,"td"),_._uU(8),_.qZA(),_.TgZ(9,"td"),_._uU(10),_.qZA(),_.TgZ(11,"td"),_._uU(12),_.qZA(),_.TgZ(13,"td"),_._uU(14),_.qZA(),_.TgZ(15,"td"),_._uU(16),_.ALo(17,"date"),_.qZA(),_.TgZ(18,"td"),_._uU(19),_.ALo(20,"date"),_.qZA(),_.qZA()),2&t){var i=e.$implicit;_.xp6(2),_.Oqu(i.id),_.xp6(2),_.Oqu(i.title),_.xp6(2),_.Oqu(i.order_since),_.xp6(2),_.Oqu(i.orders_freq),_.xp6(2),_.Oqu(i.total_orders),_.xp6(2),_.Oqu(i.sold_qty),_.xp6(2),_.Oqu(i.avail_qty),_.xp6(2),_.Oqu(_.xi3(17,9,i.start_order_date,"dd/MM/yyyy")),_.xp6(3),_.Oqu(_.xi3(20,12,i.end_order_date,"dd/MM/yyyy"))}}var W=function(){return[10,25,50]},G=function(){var t=function(){function t(e,n){i(this,t),this.stockService=e,this.dateUtilService=n,this.items=[],this.fromdate="",this.todate="",this.incother=!1}return e(t,[{key:"ngOnInit",value:function(){this.fromdate=this.dateUtilService.getOtherDate(new Date,-90),this.todate=this.dateUtilService.getFormatDate(new Date),this.incother=!1,this.filter()}},{key:"filter",value:function(){var t=this;console.log("incother: ",this.incother),this.stockService.findDemand(this.fromdate,this.todate,!this.incother).subscribe(function(e){t.items=e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(J.q),_.Y36(N.m))},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:13,vars:12,consts:[[1,"row"],[1,"col-12"],["type","date",3,"ngModel","max","ngModelChange","input"],["type","checkbox",3,"ngModel","ngModelChange","change"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","id"],["type","text","field","id","display","menu"],["field","id"],["pSortableColumn","title"],["type","text","field","title","display","menu"],["field","title"],["pSortableColumn","order_since"],["type","text","field","order_since","display","menu"],["field","order_since"],["pSortableColumn","orders_freq"],["type","text","field","orders_freq","display","menu"],["field","orders_freq"],["pSortableColumn","total_orders"],["field","total_orders"],["pSortableColumn","sold_qty"],["field","sold_qty"],["pSortableColumn","avail_qty"],["field","avail_qty"],["pSortableColumn","start_order_date"],["type","date","field","start_order_date","display","menu"],["field","start_order_date"],["pSortableColumn","end_order_date"],["type","date","field","end_order_date","display","menu"],["field","end_order_date"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_._uU(2," From: "),_.TgZ(3,"input",2),_.NdJ("ngModelChange",function(t){return e.fromdate=t})("input",function(){return e.filter()}),_.qZA(),_._uU(4," To: "),_.TgZ(5,"input",2),_.NdJ("ngModelChange",function(t){return e.todate=t})("input",function(){return e.filter()}),_.qZA(),_.TgZ(6,"input",3),_.NdJ("ngModelChange",function(t){return e.incother=t})("change",function(){return e.filter()}),_.qZA(),_._uU(7," Include Other "),_.qZA(),_.TgZ(8,"div",1),_.TgZ(9,"p-table",4,5),_.YNc(11,H,34,0,"ng-template",6),_.YNc(12,K,21,15,"ng-template",7),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.xp6(3),_.Q6J("ngModel",e.fromdate)("max",e.todate),_.xp6(2),_.Q6J("ngModel",e.todate)("max",e.todate),_.xp6(1),_.Q6J("ngModel",e.incother),_.xp6(3),_.Q6J("value",e.items)("resizableColumns",!0)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(11,W)))},directives:[a.Fj,a.JJ,a.On,a.Wl,p.iA,P.jx,p.lQ,p.xl,p.fz],pipes:[r.uU],styles:[".batch[_ngcontent-%COMP%]{color:#00f;font-style:italic;font-size:smaller}.adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t}(),tt=function(){var t=e(function t(){i(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&_._uU(0," Credit Component\n")},encapsulation:2}),t}();function et(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"th"),_.TgZ(2,"input",34),_.NdJ("change",function(t){return _.CHM(i),_.oxw().selectAllItem(t)}),_.qZA(),_.qZA(),_.TgZ(3,"th",35),_._uU(4,"Invoice No "),_._UZ(5,"p-columnFilter",36),_._UZ(6,"p-sortIcon",37),_.qZA(),_.TgZ(7,"th",38),_._uU(8,"Product "),_._UZ(9,"p-columnFilter",39),_._UZ(10,"p-sortIcon",40),_.qZA(),_.TgZ(11,"th",41),_._uU(12,"Expiry "),_._UZ(13,"p-sortIcon",42),_.qZA(),_.TgZ(14,"th"),_._uU(15,"Purchased"),_.qZA(),_.TgZ(16,"th"),_._uU(17,"Sold"),_.qZA(),_.TgZ(18,"th"),_._uU(19,"Adjusted"),_.qZA(),_.TgZ(20,"th",43),_._uU(21,"Available "),_._UZ(22,"p-columnFilter",44),_._UZ(23,"p-sortIcon",45),_.qZA(),_.TgZ(24,"th"),_._uU(25,"Actions"),_.qZA(),_.qZA()}}var it=function(t){return["/secure/purchases/items",t]};function nt(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr"),_.TgZ(1,"td"),_.TgZ(2,"input",46),_.NdJ("change",function(t){var e=_.CHM(i).$implicit;return _.oxw().selectItem(t,e.id)}),_.qZA(),_.qZA(),_.TgZ(3,"td"),_.TgZ(4,"a",47),_._uU(5),_.qZA(),_.qZA(),_.TgZ(6,"td"),_.TgZ(7,"p"),_._uU(8),_.qZA(),_.TgZ(9,"span",16),_._uU(10),_.qZA(),_.qZA(),_.TgZ(11,"td"),_._uU(12),_.ALo(13,"date"),_.qZA(),_.TgZ(14,"td",48),_._uU(15),_.qZA(),_.TgZ(16,"td",48),_._uU(17),_.qZA(),_.TgZ(18,"td",48),_._uU(19),_.qZA(),_.TgZ(20,"td",48),_._uU(21),_.qZA(),_.TgZ(22,"td",49),_.TgZ(23,"span",50),_._uU(24," \xa0"),_.TgZ(25,"a",51),_.NdJ("click",function(){var t=_.CHM(i).$implicit;return _.oxw().showQtyDialog(t)}),_._UZ(26,"i",52),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&t){var n=e.$implicit;_.xp6(2),_.Q6J("checked",n.selected),_.xp6(2),_.Q6J("routerLink",_.VKq(13,it,n.purchase_invoiceid)),_.xp6(1),_.Oqu(n.invoice_no),_.xp6(3),_.Oqu(n.product_title),_.xp6(2),_.Oqu(n.product_batch),_.xp6(2),_.Oqu(_.xi3(13,10,n.product_expdate,"MMM-yy")),_.xp6(3),_.Oqu(n.purchased),_.xp6(2),_.Oqu(n.sold),_.xp6(2),_.Oqu(n.adjusted),_.xp6(2),_.Oqu(n.available)}}function ot(t,e){if(1&t&&(_.TgZ(0,"option",53),_._uU(1),_.qZA()),2&t){var i=e.$implicit;_.Q6J("value",i.value),_.xp6(1),_.Oqu(i.label)}}function rt(t,e){if(1&t&&(_.TgZ(0,"option",53),_._uU(1),_.qZA()),2&t){var i=e.$implicit;_.Q6J("value",i.value),_.xp6(1),_.Oqu(i.label)}}var at=function(){return[25,50,100]},lt=function(){var t=function(){function t(e,n,o){i(this,t),this.service=e,this.invoiceService=n,this.dateService=o,this.items=[],this.displayQtyAdjForm=!1,this.displayQtyBulkAdjForm=!1,this.finalqty=0,this.maxAllowed=0,this.minAllowed=0,this.available=!0,this.expired=!1,this.inactive=!1,this.qtyAdjustForm=new a.cw({itemid:new a.NI("",a.kI.required),reason:new a.NI("",a.kI.required),qty:new a.NI(0,a.kI.required),comments:new a.NI("")}),this.qtyBulkAdjustForm=new a.cw({reason:new a.NI("",a.kI.required),comments:new a.NI("")}),this.qtyChangeReasons=[{value:"Damaged",label:"Damaged"},{value:"Missing",label:"Missing"},{value:"Expired",label:"Expired"},{value:"Other",label:"Other"}]}return e(t,[{key:"ngOnInit",value:function(){this.fetchStock()}},{key:"complete",value:function(){var t=this,e=[];this.items.forEach(function(t){t.selected&&e.push(t.id)}),this.invoiceService.updateItems(e,{status:"VERIFIED",verifyenddate:this.dateService.getFormatDate(new Date)}).subscribe(function(e){return t.fetchStock()})}},{key:"bulkadjust",value:function(){this.displayQtyBulkAdjForm=!0}},{key:"fetchStock",value:function(){var t=this;this.service.filterByCriteria({available:this.available,expired:this.expired,status:"AUDIT"}).subscribe(function(e){t.items=e.map(function(t){return Object.assign(Object.assign({},t),{available:+t.available})})})}},{key:"selectItem",value:function(t,e){this.items.forEach(function(t){t.id==e&&(t.selected=!0)})}},{key:"selectAllItem",value:function(t){this.items.forEach(function(e){e.selected=t.target.checked})}},{key:"showQtyDialog",value:function(t){this.selectedItem=t,this.qtyAdjustForm.reset(),this.qtyAdjustForm.controls.itemid.setValue(t.purchase_itemid),this.displayQtyAdjForm=!0,this.finalqty=this.selectedItem.available,this.minAllowed=-1*+this.selectedItem.available}},{key:"onQtyAdjSubmit",value:function(){var t=this;this.service.updateQty(this.qtyAdjustForm.value).subscribe(function(e){t.fetchStock(),t.displayQtyAdjForm=!1})}},{key:"isItemsSelected",value:function(){return this.items.filter(function(t){return t.selected}).length>0}},{key:"onQtyBulkAdjSubmit",value:function(){var t=this,e=[];this.items.forEach(function(t){t.selected&&e.push(t.id)}),this.service.updateQtyToZero({ids:e,reason:this.qtyBulkAdjustForm.controls.reason.value,comments:this.qtyBulkAdjustForm.controls.comments.value}).subscribe(function(e){t.fetchStock(),t.qtyBulkAdjustForm.reset(),t.displayQtyBulkAdjForm=!1})}},{key:"onQtyChange",value:function(t){this.finalqty=this.selectedItem.available-1*this.qtyAdjustForm.controls.qty.value*-1}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(J.q),_.Y36(Q.q),_.Y36(N.m))},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:76,vars:29,consts:[[1,"row","mt-2"],[1,"col-12"],["type","checkbox","name","available","id","available",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","available",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],["type","checkbox","name","expired","id","expired",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","expired",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],[1,"btn","btn-outline-success",3,"disabled","click"],["columnResizeMode","expand","styleClass","p-datatable-gridlines mt-4","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"value","resizableColumns","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["dt1",""],["pTemplate","header"],["pTemplate","body"],["header","Stock Adjustment",3,"visible","modal","visibleChange"],[3,"formGroup","ngSubmit"],[1,"container"],[1,"row"],[1,"col-12","p-0"],[1,"batch"],[1,"col-md-2","m-0","p-0"],["for","price",1,"adj-label"],["for","qty",1,"adj-label"],["type","number","id","qty","formControlName","qty",1,"form-control",3,"min","input"],[1,"col-md-2"],["for","newqty",1,"adj-label"],[1,"col-md-3","m-0","p-0"],["for","reason",1,"adj-label"],["formControlName","reason",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","p-0"],["for","comments",1,"adj-label"],["id","comments","placeholder","Explain the reason for adjustment","formControlName","comments",1,"form-control"],[1,"row","mt-3"],["type","submit",1,"btn","btn-primary",3,"disabled"],["header","Bulk Adjustment",3,"visible","modal","visibleChange"],["type","checkbox",1,"form-conrol-input","checkmark",3,"change"],["pSortableColumn","invoice_no"],["type","text","field","invoice_no","display","menu"],["field","invoice_no"],["pSortableColumn","product_title"],["type","text","field","product_title","display","menu"],["field","product_title"],["pSortableColumn","product_expdate"],["field","product_expdate"],["pSortableColumn","available"],["type","numeric","field","available","display","menu"],["field","available"],["type","checkbox",1,"form-conrol-input","checkmark",3,"checked","change"],[3,"routerLink"],[1,"text-end"],[1,"text-center"],[1,"ml-2"],["href","javascript:void(0)",3,"click"],[1,"bi","bi-pencil-square","text-primary"],[3,"value"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"input",2),_.NdJ("ngModelChange",function(t){return e.available=t})("change",function(){return e.fetchStock()}),_.qZA(),_.TgZ(3,"label",3),_._uU(4,"Available"),_.qZA(),_.TgZ(5,"input",4),_.NdJ("ngModelChange",function(t){return e.expired=t})("change",function(){return e.fetchStock()}),_.qZA(),_.TgZ(6,"label",5),_._uU(7,"Expired"),_.qZA(),_.qZA(),_.TgZ(8,"div",1),_.TgZ(9,"button",6),_.NdJ("click",function(){return e.complete()}),_._uU(10,"Complete"),_.qZA(),_._uU(11,"\xa0\xa0 "),_.qZA(),_.TgZ(12,"div",1),_.TgZ(13,"p-table",7,8),_.YNc(15,et,26,0,"ng-template",9),_.YNc(16,nt,27,15,"ng-template",10),_.qZA(),_.qZA(),_.qZA(),_.TgZ(17,"p-dialog",11),_.NdJ("visibleChange",function(t){return e.displayQtyAdjForm=t}),_.TgZ(18,"form",12),_.NdJ("ngSubmit",function(){return e.onQtyAdjSubmit()}),_.TgZ(19,"div",13),_.TgZ(20,"div",14),_.TgZ(21,"div",15),_.TgZ(22,"h5"),_._uU(23),_.qZA(),_.TgZ(24,"p",16),_._uU(25),_.ALo(26,"date"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(27,"div",14),_.TgZ(28,"div",17),_.TgZ(29,"label",18),_._uU(30,"Current"),_.qZA(),_._UZ(31,"br"),_._uU(32),_.qZA(),_.TgZ(33,"div",17),_.TgZ(34,"label",19),_._uU(35,"Adjust"),_.qZA(),_.TgZ(36,"input",20),_.NdJ("input",function(t){return e.onQtyChange(t)}),_.qZA(),_.qZA(),_.TgZ(37,"div",21),_.TgZ(38,"label",22),_._uU(39,"Final"),_.qZA(),_._UZ(40,"br"),_._uU(41),_.qZA(),_.TgZ(42,"div",23),_.TgZ(43,"label",24),_._uU(44,"Reason"),_.qZA(),_.TgZ(45,"select",25),_.TgZ(46,"option",26),_._uU(47,"Select"),_.qZA(),_.YNc(48,ot,2,2,"option",27),_.qZA(),_.qZA(),_.TgZ(49,"div",28),_.TgZ(50,"label",29),_._uU(51,"Comments"),_.qZA(),_._UZ(52,"textarea",30),_.qZA(),_.qZA(),_.TgZ(53,"div",31),_.TgZ(54,"div",28),_.TgZ(55,"button",32),_._uU(56,"Save"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(57,"p-dialog",33),_.NdJ("visibleChange",function(t){return e.displayQtyBulkAdjForm=t}),_.TgZ(58,"form",12),_.NdJ("ngSubmit",function(){return e.onQtyBulkAdjSubmit()}),_.TgZ(59,"div",13),_.TgZ(60,"div",14),_.TgZ(61,"div",1),_.TgZ(62,"label",24),_._uU(63,"Reason"),_.qZA(),_.TgZ(64,"select",25),_.TgZ(65,"option",26),_._uU(66,"Select"),_.qZA(),_.YNc(67,rt,2,2,"option",27),_.qZA(),_.qZA(),_.TgZ(68,"div",1),_.TgZ(69,"label",29),_._uU(70,"Comments"),_.qZA(),_._UZ(71,"textarea",30),_.qZA(),_.qZA(),_.TgZ(72,"div",31),_.TgZ(73,"div",28),_.TgZ(74,"button",32),_._uU(75,"Save"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.xp6(2),_.Q6J("ngModel",e.available),_.xp6(3),_.Q6J("ngModel",e.expired),_.xp6(4),_.Q6J("disabled",!e.isItemsSelected()),_.xp6(4),_.Q6J("value",e.items)("resizableColumns",!0)("paginator",!0)("rows",25)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(28,at)),_.xp6(4),_.Q6J("visible",e.displayQtyAdjForm)("modal",!0),_.xp6(1),_.Q6J("formGroup",e.qtyAdjustForm),_.xp6(5),_.Oqu(null==e.selectedItem?null:e.selectedItem.product_title),_.xp6(2),_.AsE("",null==e.selectedItem?null:e.selectedItem.product_batch," / ",_.xi3(26,25,null==e.selectedItem?null:e.selectedItem.product_expdate,"MMM-yy"),""),_.xp6(7),_.hij(" ",null==e.selectedItem?null:e.selectedItem.available," "),_.xp6(4),_.Q6J("min",e.minAllowed),_.xp6(5),_.hij(" ",e.finalqty," "),_.xp6(7),_.Q6J("ngForOf",e.qtyChangeReasons),_.xp6(7),_.Q6J("disabled",!e.qtyAdjustForm.valid),_.xp6(2),_.Q6J("visible",e.displayQtyBulkAdjForm)("modal",!0),_.xp6(1),_.Q6J("formGroup",e.qtyBulkAdjustForm),_.xp6(9),_.Q6J("ngForOf",e.qtyChangeReasons),_.xp6(7),_.Q6J("disabled",!e.qtyBulkAdjustForm.valid))},directives:[a.Wl,a.JJ,a.On,p.iA,P.jx,d.V,a._Y,a.JL,a.sg,a.wV,a.qQ,a.Fj,a.u,a.EJ,a.YN,a.Kr,r.sg,p.lQ,p.xl,p.fz,l.yS],pipes:[r.uU],styles:[".adj-label[_ngcontent-%COMP%]{color:#aaa;font-weight:bold;margin-bottom:.5em}"]}),t}(),ut=function(){var t=e(function t(){i(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(t,e){1&t&&_._UZ(0,"router-outlet")},directives:[l.lC],encapsulation:2}),t}(),ct=o(9765),st=o(2340),dt=o(1841),pt=function(){var t=function(){function t(e){i(this,t),this.http=e,this.products=new ct.xQ,this.stats=new ct.xQ,this.apiurl=st.N.apiHost+"/stock2"}return e(t,[{key:"getProducts",value:function(){return this.products}},{key:"getProductStats",value:function(){return this.stats}},{key:"refreshProducts",value:function(){this.findAll(this.filter)}},{key:"findAll",value:function(t){var e=this;this.filter=t,this.http.post(this.apiurl,this.filter).subscribe(function(t){e.products.next(t)})}},{key:"findByProduct",value:function(t){var e=this;this.http.get("".concat(this.apiurl,"/").concat(t)).subscribe(function(t){e.stats.next(t)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.LFG(dt.eN))},t.\u0275prov=_.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}();function Zt(t,e){1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"th",10),_._uU(2,"Product "),_._UZ(3,"p-columnFilter",11),_._UZ(4,"p-sortIcon",12),_.qZA(),_.TgZ(5,"th",13),_._uU(6,"Last "),_._UZ(7,"p-sortIcon",14),_.qZA(),_.TgZ(8,"th"),_._uU(9,"Cust."),_.qZA(),_.TgZ(10,"th"),_._uU(11,"Avg."),_._UZ(12,"br"),_._uU(13,"Sales"),_.qZA(),_.TgZ(14,"th"),_._uU(15,"High"),_._UZ(16,"br"),_._uU(17,"Sales"),_.qZA(),_.TgZ(18,"th",15),_._uU(19,"Avail "),_._UZ(20,"p-sortIcon",16),_.qZA(),_.TgZ(21,"th",17),_._uU(22,"Level "),_._UZ(23,"p-sortIcon",18),_.qZA(),_.qZA())}var gt=function(t){return{low:t}};function mt(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr",19),_.NdJ("click",function(){var t=_.CHM(i).$implicit;return _.oxw().openData(t.id)}),_.TgZ(1,"td"),_._uU(2),_.qZA(),_.TgZ(3,"td"),_._uU(4),_.ALo(5,"date"),_.qZA(),_.TgZ(6,"td"),_._uU(7),_.qZA(),_.TgZ(8,"td"),_._uU(9),_.ALo(10,"number"),_.qZA(),_.TgZ(11,"td"),_._uU(12),_.qZA(),_.TgZ(13,"td",20),_.TgZ(14,"strong"),_._uU(15),_.qZA(),_.qZA(),_.TgZ(16,"td"),_._uU(17),_.qZA(),_.qZA()}if(2&t){var n=e.$implicit;_.Q6J("ngClass",_.VKq(14,gt,n.level<20)),_.xp6(2),_.hij("",n.title," "),_.xp6(2),_.Oqu(_.xi3(5,8,n.last_sale_date,"MM/yy")),_.xp6(3),_.Oqu(n.highest_customers),_.xp6(2),_.Oqu(_.xi3(10,11,n.average_sales,"1.0-0")),_.xp6(3),_.Oqu(n.highest_sales),_.xp6(3),_.Oqu(n.balance),_.xp6(2),_.Oqu(n.level)}}var ht=function(){return[10,25,50]},ft=function(){var t=function(){function t(e,n,o){i(this,t),this.router=e,this.activatedRoute=n,this.service=o,this.criteria={active:!0,available:!1,expired:!1,starts:!0},this.products=[]}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.service.findAll({criteria:this.criteria}),this.service.getProducts().subscribe(function(e){t.products=e})}},{key:"fetch",value:function(){this.service.findAll({criteria:this.criteria})}},{key:"openData",value:function(t){this.router.navigate(["items",t],{relativeTo:this.activatedRoute})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(l.F0),_.Y36(l.gz),_.Y36(pt))},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:19,vars:9,consts:[[1,"row","mt-2"],[1,"col-12"],[1,"d-flex"],["type","checkbox",1,"form-conrol-input","checkmark",3,"ngModel","ngModelChange","change"],["for","available",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],["for","expired",2,"margin",".3em","padding-bottom",".5em","font-size","larger"],[1,"col-6"],["styleClass","p-datatable-gridlines p-datatable-sm","currentPageReportTemplate","{totalRecords} Products",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["pSortableColumn","title"],["type","text","field","title","display","menu"],["field","title"],["pSortableColumn","last_sale_date"],["field","last_sale_date"],["pSortableColumn","balance"],["field","balance"],["pSortableColumn","level"],["field","level"],[1,"row-hover",3,"ngClass","click"],[1,"text-end"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_.TgZ(3,"input",3),_.NdJ("ngModelChange",function(t){return e.criteria.active=t})("change",function(){return e.fetch()}),_.qZA(),_.TgZ(4,"label",4),_._uU(5,"Active"),_.qZA(),_.TgZ(6,"input",3),_.NdJ("ngModelChange",function(t){return e.criteria.available=t})("change",function(){return e.fetch()}),_.qZA(),_.TgZ(7,"label",5),_._uU(8,"Available"),_.qZA(),_.TgZ(9,"input",3),_.NdJ("ngModelChange",function(t){return e.criteria.expired=t})("change",function(){return e.fetch()}),_.qZA(),_.TgZ(10,"label",5),_._uU(11,"Expired"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(12,"div",0),_.TgZ(13,"div",6),_.TgZ(14,"p-table",7),_.YNc(15,Zt,24,0,"ng-template",8),_.YNc(16,mt,18,16,"ng-template",9),_.qZA(),_.qZA(),_.TgZ(17,"div",6),_._UZ(18,"router-outlet"),_.qZA(),_.qZA()),2&t&&(_.xp6(3),_.Q6J("ngModel",e.criteria.active),_.xp6(3),_.Q6J("ngModel",e.criteria.available),_.xp6(3),_.Q6J("ngModel",e.criteria.expired),_.xp6(5),_.Q6J("value",e.products)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(8,ht)))},directives:[a.Wl,a.JJ,a.On,p.iA,P.jx,l.lC,p.lQ,p.xl,p.fz,r.mk],pipes:[r.uU,r.JJ],encapsulation:2}),t}(),qt=o(1129);function At(t,e){if(1&t&&(_.TgZ(0,"option",21),_._uU(1),_.qZA()),2&t){var i=e.$implicit;_.Q6J("value",i.value),_.xp6(1),_.Oqu(i.label)}}var vt=function(){var t=function(){function t(e){i(this,t),this.service=e,this.item={},this.saved=new _.vpe,this.finalqty=0,this.maxAllowed=0,this.minAllowed=0,this.qtyAdjustForm=new a.cw({itemid:new a.NI("",a.kI.required),reason:new a.NI("",a.kI.required),qty:new a.NI(0,a.kI.required),comments:new a.NI("")}),this.qtyChangeReasons=[{value:"Damaged",label:"Damaged"},{value:"Missing",label:"Missing"},{value:"Expired",label:"Expired"},{value:"Other",label:"Other"}]}return e(t,[{key:"ngOnChanges",value:function(t){t.item.currentValue&&(console.log(t.item.currentValue),this.qtyAdjustForm.reset(),this.qtyAdjustForm.controls.itemid.setValue(this.item.item_id),this.finalqty=this.item.balance,this.minAllowed=-1*+this.item.balance)}},{key:"onQtyChange",value:function(t){this.finalqty=this.item.balance-1*this.qtyAdjustForm.controls.qty.value*-1}},{key:"onQtyAdjSubmit",value:function(){var t=this;this.service.updateQty(this.qtyAdjustForm.value).subscribe(function(e){t.saved.emit(e)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(J.q))},t.\u0275cmp=_.Xpm({type:t,selectors:[["app-stock-adjust-form"]],inputs:{item:"item"},outputs:{saved:"saved"},features:[_.TTD],decls:39,vars:12,consts:[[3,"formGroup","ngSubmit"],[1,"container"],[1,"row"],[1,"col-12","p-0"],[1,"batch"],[1,"col-md-2","m-0","p-0"],["for","price",1,"adj-label"],["for","qty",1,"adj-label"],["type","number","id","qty","formControlName","qty",1,"form-control",3,"min","input"],[1,"col-md-2"],["for","newqty",1,"adj-label"],[1,"col-md-3","m-0","p-0"],["for","reason",1,"adj-label"],["formControlName","reason",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-12","p-0"],["for","comments",1,"adj-label"],["id","comments","placeholder","Explain the reason for adjustment","formControlName","comments",1,"form-control"],[1,"row","mt-3"],["type","submit",1,"btn","btn-primary",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(_.TgZ(0,"form",0),_.NdJ("ngSubmit",function(){return e.onQtyAdjSubmit()}),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_.TgZ(3,"div",3),_.TgZ(4,"h5"),_._uU(5),_.qZA(),_.TgZ(6,"p",4),_._uU(7),_.ALo(8,"date"),_.qZA(),_.qZA(),_.qZA(),_.TgZ(9,"div",2),_.TgZ(10,"div",5),_.TgZ(11,"label",6),_._uU(12,"Current"),_.qZA(),_._UZ(13,"br"),_._uU(14),_.qZA(),_.TgZ(15,"div",5),_.TgZ(16,"label",7),_._uU(17,"Adjust"),_.qZA(),_.TgZ(18,"input",8),_.NdJ("input",function(t){return e.onQtyChange(t)}),_.qZA(),_.qZA(),_.TgZ(19,"div",9),_.TgZ(20,"label",10),_._uU(21,"Final"),_.qZA(),_._UZ(22,"br"),_._uU(23),_.qZA(),_.TgZ(24,"div",11),_.TgZ(25,"label",12),_._uU(26,"Reason"),_.qZA(),_.TgZ(27,"select",13),_.TgZ(28,"option",14),_._uU(29,"Select"),_.qZA(),_.YNc(30,At,2,2,"option",15),_.qZA(),_.qZA(),_.TgZ(31,"div",16),_.TgZ(32,"label",17),_._uU(33,"Comments"),_.qZA(),_._UZ(34,"textarea",18),_.qZA(),_.qZA(),_.TgZ(35,"div",19),_.TgZ(36,"div",16),_.TgZ(37,"button",20),_._uU(38,"Save"),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.qZA()),2&t&&(_.Q6J("formGroup",e.qtyAdjustForm),_.xp6(5),_.Oqu(null==e.item?null:e.item.title),_.xp6(2),_.AsE("",null==e.item?null:e.item.batch," / ",_.xi3(8,9,null==e.item?null:e.item.exp_date,"MMM-yy"),""),_.xp6(7),_.hij(" ",null==e.item?null:e.item.balance," "),_.xp6(4),_.Q6J("min",e.minAllowed),_.xp6(5),_.hij(" ",e.finalqty," "),_.xp6(7),_.Q6J("ngForOf",e.qtyChangeReasons),_.xp6(7),_.Q6J("disabled",!e.qtyAdjustForm.valid))},directives:[a._Y,a.JL,a.sg,a.wV,a.qQ,a.Fj,a.JJ,a.u,a.EJ,a.YN,a.Kr,r.sg],pipes:[r.uU],encapsulation:2}),t}();function Tt(t,e){1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"th"),_._uU(2,"Date"),_.qZA(),_.TgZ(3,"th"),_._uU(4,"Inv No."),_.qZA(),_.TgZ(5,"th"),_._uU(6,"Batch"),_.qZA(),_.TgZ(7,"th"),_._uU(8,"Exp Date"),_.qZA(),_.TgZ(9,"th"),_._uU(10,"Buy"),_.qZA(),_.TgZ(11,"th"),_._uU(12,"Sel"),_.qZA(),_.TgZ(13,"th"),_._uU(14,"Adj"),_.qZA(),_.TgZ(15,"th"),_._uU(16,"Bal"),_.qZA(),_._UZ(17,"th"),_.qZA())}var bt=function(t){return{expired:t}};function _t(t,e){if(1&t){var i=_.EpF();_.TgZ(0,"tr",13),_.TgZ(1,"td"),_._uU(2),_.ALo(3,"date"),_.qZA(),_.TgZ(4,"td"),_._uU(5),_.qZA(),_.TgZ(6,"td"),_._uU(7),_.qZA(),_.TgZ(8,"td"),_._uU(9),_.ALo(10,"date"),_.qZA(),_.TgZ(11,"td",14),_._uU(12),_.qZA(),_.TgZ(13,"td",14),_._uU(14),_.qZA(),_.TgZ(15,"td",14),_._uU(16),_.qZA(),_.TgZ(17,"td",14),_._uU(18),_.qZA(),_.TgZ(19,"td"),_.TgZ(20,"h5",15),_.TgZ(21,"a",16),_.NdJ("click",function(){var t=_.CHM(i).$implicit;return _.oxw().showQtyDialog(t)}),_._UZ(22,"i",17),_.qZA(),_.qZA(),_.qZA(),_.qZA()}if(2&t){var n=e.$implicit;_.Q6J("ngClass",_.VKq(15,bt,1==n.expired)),_.xp6(2),_.Oqu(_.xi3(3,9,n.invoice_date,"dd/MM/yy")),_.xp6(3),_.Oqu(n.invoice_no),_.xp6(2),_.Oqu(n.batch),_.xp6(2),_.Oqu(_.xi3(10,12,n.exp_date,"MMM-yy")),_.xp6(3),_.Oqu(n.purchased),_.xp6(2),_.Oqu(n.sold),_.xp6(2),_.Oqu(n.adjusted),_.xp6(2),_.Oqu(n.balance)}}function yt(t,e){1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"th"),_._uU(2,"Month"),_.qZA(),_.TgZ(3,"th"),_._uU(4,"Orders"),_.qZA(),_.TgZ(5,"th"),_._uU(6,"Qty"),_.qZA(),_.qZA())}function xt(t,e){if(1&t&&(_.TgZ(0,"tr",13),_.TgZ(1,"td"),_._uU(2),_.ALo(3,"date"),_.qZA(),_.TgZ(4,"td",14),_._uU(5),_.qZA(),_.TgZ(6,"td",14),_._uU(7),_.qZA(),_.qZA()),2&t){var i=e.$implicit;_.Q6J("ngClass",_.VKq(7,bt,1==i.long)),_.xp6(2),_.Oqu(_.xi3(3,4,i.sale_month,"MMM-yy")),_.xp6(3),_.Oqu(i.total_orders),_.xp6(2),_.Oqu(i.total_qty)}}function Ut(t,e){1&t&&(_.TgZ(0,"tr"),_.TgZ(1,"th"),_._uU(2,"Month"),_.qZA(),_.TgZ(3,"th"),_._uU(4,"Name"),_.qZA(),_.TgZ(5,"th"),_._uU(6,"Mobile"),_.qZA(),_.TgZ(7,"th",14),_._uU(8,"Qty"),_.qZA(),_.TgZ(9,"th",14),_._uU(10,"Last Sold"),_.qZA(),_.qZA())}function kt(t,e){if(1&t&&(_.TgZ(0,"tr",13),_.TgZ(1,"td"),_._uU(2),_.ALo(3,"date"),_.qZA(),_.TgZ(4,"td"),_._uU(5),_.qZA(),_.TgZ(6,"td"),_._uU(7),_.qZA(),_.TgZ(8,"td",14),_._uU(9),_.qZA(),_.TgZ(10,"td",14),_._uU(11),_.ALo(12,"date"),_.qZA(),_.qZA()),2&t){var i=e.$implicit;_.Q6J("ngClass",_.VKq(11,bt,1==i.long)),_.xp6(2),_.Oqu(_.xi3(3,6,i.sale_month,"MMM-yy")),_.xp6(3),_.Oqu(i.name),_.xp6(2),_.Oqu(i.mobile),_.xp6(2),_.Oqu(i.total_qty),_.xp6(2),_.Oqu(_.lcZ(12,9,i.recent))}}var wt=function(t,e){return{"btn-outline-danger":t,"btn-outline-success":e}},Ct=function(){return[10,25,50]},Ot=[{path:"",component:M,canActivate:[u.a],children:[{path:"",redirectTo:"stock"},{path:"stock",component:I,children:[{path:"",redirectTo:"list"},{path:"list",component:E},{path:"audit",component:lt},{path:"adjust",component:X},{path:"demand",component:G}]},{path:"inventory",component:ut,children:[{path:"",redirectTo:"products"},{path:"products",component:ft,children:[{path:"items/:id",component:function(){var t=function(){function t(e,n,o){i(this,t),this.route=e,this.service=n,this.prodService=o,this.data={},this.product={},this.displayQtyAdjForm=!1}return e(t,[{key:"ngOnInit",value:function(){var t=this;this.route.params.subscribe(function(e){t.service.findByProduct(e.id),t.service.getProductStats().subscribe(function(e){e.purchases.length>0&&(t.product=e.purchases[0]),e.sales.forEach(function(e){e.long=t.isAfterDays(e.sale_month,180)}),e.customers.forEach(function(e){e.long=t.isAfterDays(e.sale_month,180)}),t.data=e})})}},{key:"isAfterDays",value:function(t,e){var i=new Date(t).getTime();return((new Date).getTime()-i)/1e3/60/60/24>e}},{key:"showQtyDialog",value:function(t){this.selectedItem=t,this.displayQtyAdjForm=!0}},{key:"closeAdjForm",value:function(t){this.displayQtyAdjForm=!1,this.service.findByProduct(this.selectedItem.id),this.service.refreshProducts()}},{key:"toggleActive",value:function(t){var e=this;this.prodService.update(t.id,{isActive:!t.active}).subscribe(function(i){1==i.affected&&(e.product.active=!t.active)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(_.Y36(l.gz),_.Y36(pt),_.Y36(qt.s))},t.\u0275cmp=_.Xpm({type:t,selectors:[["ng-component"]],decls:25,vars:27,consts:[[1,"row"],[1,"col-12"],[1,"col-10","d-flex"],[1,"col-2","d-flex","text-end"],[1,"btn","btn-sm",3,"ngClass","click"],["header","Purchase"],["styleClass","p-datatable-gridlines p-datatable-sm","currentPageReportTemplate","{totalRecords} Items",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions"],["pTemplate","header"],["pTemplate","body"],["header","Sale"],["header","Customer"],["header","Stock Adjustment",3,"visible","modal","visibleChange"],[3,"item","saved"],[3,"ngClass"],[2,"text-align","right"],[1,"icon"],["href","javascript:void(0)",3,"click"],[1,"bi","bi-pencil-square","text-primary"]],template:function(t,e){1&t&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.TgZ(2,"div",2),_.TgZ(3,"h5"),_._uU(4),_.qZA(),_.qZA(),_.TgZ(5,"div",3),_.TgZ(6,"button",4),_.NdJ("click",function(){return e.toggleActive(e.product)}),_.TgZ(7,"span"),_._uU(8),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(9,"p-tabView"),_.TgZ(10,"p-tabPanel",5),_.TgZ(11,"div",1),_.TgZ(12,"p-table",6),_.YNc(13,Tt,18,0,"ng-template",7),_.YNc(14,_t,23,17,"ng-template",8),_.qZA(),_.qZA(),_.qZA(),_.TgZ(15,"p-tabPanel",9),_.TgZ(16,"p-table",6),_.YNc(17,yt,7,0,"ng-template",7),_.YNc(18,xt,8,9,"ng-template",8),_.qZA(),_.qZA(),_.TgZ(19,"p-tabPanel",10),_.TgZ(20,"p-table",6),_.YNc(21,Ut,11,0,"ng-template",7),_.YNc(22,kt,13,13,"ng-template",8),_.qZA(),_.qZA(),_.qZA(),_.qZA(),_.TgZ(23,"p-dialog",11),_.NdJ("visibleChange",function(t){return e.displayQtyAdjForm=t}),_.TgZ(24,"app-stock-adjust-form",12),_.NdJ("saved",function(t){return e.closeAdjForm(t)}),_.qZA(),_.qZA()),2&t&&(_.xp6(4),_.Oqu(e.product.title),_.xp6(2),_.Q6J("ngClass",_.WLB(21,wt,e.product.active,!e.product.active)),_.xp6(2),_.Oqu(e.product.active?"Disable":"Enable"),_.xp6(4),_.Q6J("value",e.data.purchases)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(24,Ct)),_.xp6(4),_.Q6J("value",e.data.sales)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(25,Ct)),_.xp6(4),_.Q6J("value",e.data.customers)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",_.DdM(26,Ct)),_.xp6(3),_.Q6J("visible",e.displayQtyAdjForm)("modal",!0),_.xp6(1),_.Q6J("item",e.selectedItem))},directives:[r.mk,v.xf,v.x4,p.iA,P.jx,d.V,vt],pipes:[r.uU],encapsulation:2}),t}()}]}]},{path:"cash",component:j},{path:"credit",component:tt}]}],Mt=function(){var t=e(function t(){i(this,t)});return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=_.oAB({type:t}),t.\u0275inj=_.cJS({imports:[[l.Bz.forChild(Ot),a.u5,r.ez,a.UX,s.WN,g._8,d.S,p.U$,Z.EV,v.LU,m.JH,h.q4,f.vI,q.hJ,A.kW,T.q,b.j,c.m],l.Bz]}),t}()}}])}();